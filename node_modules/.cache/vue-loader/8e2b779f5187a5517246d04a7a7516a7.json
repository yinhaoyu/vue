{"remainingRequest":"/Users/yoon/jz-video/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yoon/jz-video/src/components/vue-cropper/vue-cropper.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/yoon/jz-video/src/components/vue-cropper/vue-cropper.vue","mtime":1582719600788},{"path":"/Users/yoon/jz-video/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yoon/jz-video/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yoon/jz-video/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yoon/jz-video/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yoon/jz-video/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi52dWUtY3JvcHBlciB7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogMTAwJTsKICAgIGhlaWdodDogMTAwJTsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKICAgIC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7CiAgICAtbW96LXVzZXItc2VsZWN0OiBub25lOwogICAgLW1zLXVzZXItc2VsZWN0OiBub25lOwogICAgZGlyZWN0aW9uOiBsdHI7CiAgICB0b3VjaC1hY3Rpb246IG5vbmU7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDAwOwogICAgLyogYmFja2dyb3VuZC1pbWFnZTogdXJsKCdkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQVFBUU1BQUFBbFBXMGlBQUFBQTNOQ1NWUUlDQWpiNFUvZ0FBQUFCbEJNVkVYTXpNei8vLy9UalJWMkFBQUFDWEJJV1hNQUFBcnJBQUFLNndHQ2l3MWFBQUFBSEhSRldIUlRiMlowZDJGeVpRQkJaRzlpWlNCR2FYSmxkMjl5YTNNZ1ExTTI2THl5akFBQUFCRkpSRUZVQ0psaitNL0FnQlZoRi8wUEFINi9EL0hrRHhPR0FBQUFBRWxGVGtTdVFtQ0MnKTsgKi8KfQoKLmNyb3BwZXItYm94LAouY3JvcHBlci1ib3gtY2FudmFzLAouY3JvcHBlci1kcmFnLWJveCwKLmNyb3BwZXItY3JvcC1ib3gsCi5jcm9wcGVyLWZhY2UgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgdG9wOiAwOwogICAgcmlnaHQ6IDA7CiAgICBib3R0b206IDA7CiAgICBsZWZ0OiAwOwogICAgdXNlci1zZWxlY3Q6IG5vbmU7Cn0KCi5jcm9wcGVyLWJveC1jYW52YXMgaW1nIHsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHVzZXItc2VsZWN0OiBub25lOwogICAgdHJhbnNmb3JtOiBub25lOwogICAgbWF4LXdpZHRoOiBub25lOwogICAgbWF4LWhlaWdodDogbm9uZTsKfQoKLmNyb3BwZXItYm94IHsKICAgIG92ZXJmbG93OiBoaWRkZW47Cn0KCi5jcm9wcGVyLW1vdmUgewogICAgY3Vyc29yOiBtb3ZlOwp9CgouY3JvcHBlci1jcm9wIHsKICAgIGN1cnNvcjogY3Jvc3NoYWlyOwp9CgouY3JvcHBlci1tb2RhbCB7CiAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNSk7Cn0KCi5jcm9wcGVyLWNyb3AtYm94IHsKICAgIC8qYm9yZGVyOiAycHggc29saWQgIzQ0YTg3MDsqLwp9CgouY3JvcHBlci12aWV3LWJveCB7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICB3aWR0aDogMTAwJTsKICAgIGhlaWdodDogMTAwJTsKICAgIG91dGxpbmU6IDFweCBzb2xpZCAjNDRhODcwOwogICAgb3V0bGluZS1jb2xvcjogIzQ0YTg3MDsKICAgIHVzZXItc2VsZWN0OiBub25lOwp9CgouY3JvcHBlci12aWV3LWJveCBpbWcgewogICAgdXNlci1zZWxlY3Q6IG5vbmU7CiAgICBtYXgtd2lkdGg6IG5vbmU7CiAgICBtYXgtaGVpZ2h0OiBub25lOwp9CgouY3JvcHBlci1mYWNlIHsKICAgIHRvcDogMDsKICAgIGxlZnQ6IDA7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOwogICAgb3BhY2l0eTogMC4xOwp9CgouY3JvcC1pbmZvIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGxlZnQ6IDBweDsKICAgIG1pbi13aWR0aDogNjVweDsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIGxpbmUtaGVpZ2h0OiAyMHB4OwogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjgpOwogICAgZm9udC1zaXplOiAxMnB4Owp9CgouY3JvcC1saW5lIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBvcGFjaXR5OiAuMTsKfQoKLmxpbmUtdyB7CiAgICB0b3A6IC0zcHg7CiAgICBsZWZ0OiAwOwogICAgaGVpZ2h0OiA1cHg7CiAgICBjdXJzb3I6IG4tcmVzaXplOwp9CgoubGluZS1hIHsKICAgIHRvcDogMDsKICAgIGxlZnQ6IC0zcHg7CiAgICB3aWR0aDogNXB4OwogICAgY3Vyc29yOiB3LXJlc2l6ZTsKfQoKLmxpbmUtcyB7CiAgICBib3R0b206IC0zcHg7CiAgICBsZWZ0OiAwOwogICAgaGVpZ2h0OiA1cHg7CiAgICBjdXJzb3I6IHMtcmVzaXplOwp9CgoubGluZS1kIHsKICAgIHRvcDogMDsKICAgIHJpZ2h0OiAtM3B4OwogICAgd2lkdGg6IDVweDsKICAgIGN1cnNvcjogZS1yZXNpemU7Cn0KCi5jcm9wLXBvaW50IHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiA4cHg7CiAgICBoZWlnaHQ6IDhweDsKICAgIG9wYWNpdHk6IC43NTsKICAgIGJhY2tncm91bmQtY29sb3I6ICM0NGE4NzA7CiAgICBib3JkZXItcmFkaXVzOiAxMDAlOwp9CgoucG9pbnQxIHsKICAgIHRvcDogLTRweDsKICAgIGxlZnQ6IC00cHg7CiAgICBjdXJzb3I6IG53LXJlc2l6ZTsKfQoKLnBvaW50MiB7CiAgICB0b3A6IC01cHg7CiAgICBsZWZ0OiA1MCU7CiAgICBtYXJnaW4tbGVmdDogLTNweDsKICAgIGN1cnNvcjogbi1yZXNpemU7Cn0KCi5wb2ludDMgewogICAgdG9wOiAtNHB4OwogICAgcmlnaHQ6IC00cHg7CiAgICBjdXJzb3I6IG5lLXJlc2l6ZTsKfQoKLnBvaW50NCB7CiAgICB0b3A6IDUwJTsKICAgIGxlZnQ6IC00cHg7CiAgICBtYXJnaW4tdG9wOiAtM3B4OwogICAgY3Vyc29yOiB3LXJlc2l6ZTsKfQoKLnBvaW50NSB7CiAgICB0b3A6IDUwJTsKICAgIHJpZ2h0OiAtNHB4OwogICAgbWFyZ2luLXRvcDogLTNweDsKICAgIGN1cnNvcjogdy1yZXNpemU7Cn0KCi5wb2ludDYgewogICAgYm90dG9tOiAtNXB4OwogICAgbGVmdDogLTRweDsKICAgIGN1cnNvcjogc3ctcmVzaXplOwp9CgoucG9pbnQ3IHsKICAgIGJvdHRvbTogLTVweDsKICAgIGxlZnQ6IDUwJTsKICAgIG1hcmdpbi1sZWZ0OiAtM3B4OwogICAgY3Vyc29yOiBzLXJlc2l6ZTsKfQoKLnBvaW50OCB7CiAgICBib3R0b206IC01cHg7CiAgICByaWdodDogLTRweDsKICAgIGN1cnNvcjogbnctcmVzaXplOwp9CgpAbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiA1MDBweCkgewogICAgLmNyb3AtcG9pbnQgewogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICB3aWR0aDogMjBweDsKICAgICAgICBoZWlnaHQ6IDIwcHg7CiAgICAgICAgb3BhY2l0eTogLjQ1OwogICAgICAgIGJhY2tncm91bmQtY29sb3I6ICM0NGE4NzA7CiAgICAgICAgYm9yZGVyLXJhZGl1czogMTAwJTsKICAgIH0KCiAgICAucG9pbnQxIHsKICAgICAgICB0b3A6IC0xMHB4OwogICAgICAgIGxlZnQ6IC0xMHB4OwogICAgfQoKICAgIC5wb2ludDIsCiAgICAucG9pbnQ0LAogICAgLnBvaW50NSwKICAgIC5wb2ludDcgewogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICB9CgogICAgLnBvaW50MyB7CiAgICAgICAgdG9wOiAtMTBweDsKICAgICAgICByaWdodDogLTEwcHg7CiAgICB9CgogICAgLnBvaW50NCB7CiAgICAgICAgdG9wOiAwOwogICAgICAgIGxlZnQ6IDA7CiAgICB9CgogICAgLnBvaW50NiB7CiAgICAgICAgYm90dG9tOiAtMTBweDsKICAgICAgICBsZWZ0OiAtMTBweDsKICAgIH0KCiAgICAucG9pbnQ4IHsKICAgICAgICBib3R0b206IC0xMHB4OwogICAgICAgIHJpZ2h0OiAtMTBweDsKICAgIH0KfQoK"},{"version":3,"sources":["vue-cropper.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4sCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"vue-cropper.vue","sourceRoot":"src/components/vue-cropper","sourcesContent":["<template>\n    <div class=\"vue-cropper\" ref=\"cropper\" @mouseover=\"scaleImg\" @mouseout=\"cancleScale\">\n        <div class=\"cropper-box\">\n            <div class=\"cropper-box-canvas\" v-show=\"!loading\" :style=\"{\n                    'width': trueWidth + 'px',\n                    'height': trueHeight + 'px',\n                    'transform': 'scale(' + scale + ',' + scale + ') ' + 'translate3d('+ x / scale + 'px,' + y / scale + 'px,' + '0)'\n                    + 'rotateZ('+ rotate * 90 +'deg)'\n                    }\">\n                <img :src=\"imgs\" alt=\"cropper-img\" ref=\"cropperImg\" />\n            </div>\n        </div>\n        <div class=\"cropper-drag-box\" :class=\"{'cropper-move': move && !crop, 'cropper-crop': crop, 'cropper-modal': cropping}\" @mousedown=\"startMove\" @touchstart=\"startMove\">\n        </div>\n        <div v-show=\"cropping\" class=\"cropper-crop-box\" :style=\"{\n                    'width': cropW + 'px',\n                    'height': cropH + 'px',\n                    'transform': 'translate3d('+ cropOffsertX + 'px,' + cropOffsertY + 'px,' + '0)'\n                }\">\n            <span class=\"cropper-view-box\">\n                    <img\n                    :style=\"{\n                        'width': trueWidth + 'px',\n                        'height': trueHeight + 'px',\n                        'transform': 'scale(' + scale + ',' + scale + ') ' + 'translate3d('+ (x - cropOffsertX) / scale  + 'px,' + (y - cropOffsertY) / scale + 'px,' + '0)'\n                        + 'rotateZ('+ rotate * 90 +'deg)'\n                        }\"\n                        :src=\"imgs\"\n                        alt=\"cropper-img\"\n                        />\n                </span>\n            <span class=\"cropper-face cropper-move\" @mousedown=\"cropMove\" @touchstart=\"cropMove\"></span>\n            <span class=\"crop-info\" v-if=\"info\" :style=\"{'top': cropInfo}\">{{  this.cropW > 0 ? this.cropW : 0 }} × {{ this.cropH > 0 ? this.cropH : 0 }}</span>\n            <span v-if=\"!fixedBox\">\n                    <span class=\"crop-line line-w\" @mousedown=\"changeCropSize($event, false, true, 0, 1)\" @touchstart=\"changeCropSize($event, false, true, 0, 1)\"></span>\n            <span class=\"crop-line line-a\" @mousedown=\"changeCropSize($event, true, false, 1, 0)\" @touchstart=\"changeCropSize($event, true, false, 1, 0)\"></span>\n            <span class=\"crop-line line-s\" @mousedown=\"changeCropSize($event, false, true, 0, 2)\" @touchstart=\"changeCropSize($event, false, true, 0, 2)\"></span>\n            <span class=\"crop-line line-d\" @mousedown=\"changeCropSize($event, true, false, 2, 0)\" @touchstart=\"changeCropSize($event, true, false, 2, 0)\"></span>\n            <span class=\"crop-point point1\" @mousedown=\"changeCropSize($event, true, true, 1, 1)\" @touchstart=\"changeCropSize($event, true, true, 1, 1)\"></span>\n            <span class=\"crop-point point2\" @mousedown=\"changeCropSize($event, false, true, 0, 1)\" @touchstart=\"changeCropSize($event, false, true, 0, 1)\"></span>\n            <span class=\"crop-point point3\" @mousedown=\"changeCropSize($event, true, true, 2, 1)\" @touchstart=\"changeCropSize($event, true, true, 2, 1)\"></span>\n            <span class=\"crop-point point4\" @mousedown=\"changeCropSize($event, true, false, 1, 0)\" @touchstart=\"changeCropSize($event, true, false, 1, 0)\"></span>\n            <span class=\"crop-point point5\" @mousedown=\"changeCropSize($event, true, false, 2, 0)\" @touchstart=\"changeCropSize($event, true, false, 2, 0)\"></span>\n            <span class=\"crop-point point6\" @mousedown=\"changeCropSize($event, true, true, 1, 2)\" @touchstart=\"changeCropSize($event, true, true, 1, 2)\"></span>\n            <span class=\"crop-point point7\" @mousedown=\"changeCropSize($event, false, true, 0, 2)\" @touchstart=\"changeCropSize($event, false, true, 0, 2)\"></span>\n            <span class=\"crop-point point8\" @mousedown=\"changeCropSize($event, true, true, 2, 2)\" @touchstart=\"changeCropSize($event, true, true, 2, 2)\"></span>\n            </span>\n        </div>\n    </div>\n</template>\n<script>\nimport exif from 'exif-js';\nexport default {\n    data: function() {\n        return {\n            // 容器高宽\n            w: 0,\n            h: 0,\n            // 图片缩放比例\n            scale: 1,\n            // 图片偏移x轴\n            x: 0,\n            // 图片偏移y轴\n            y: 0,\n            // 图片加载\n            loading: true,\n            // 图片真实宽度\n            trueWidth: 0,\n            // 图片真实高度\n            trueHeight: 0,\n            move: true,\n            // 移动的x\n            moveX: 0,\n            // 移动的y\n            moveY: 0,\n            // 开启截图\n            crop: false,\n            // 正在截图\n            cropping: false,\n            // 裁剪框大小\n            cropW: 0,\n            cropH: 0,\n            cropOldW: 0,\n            cropOldH: 0,\n            // 判断是否能够改变\n            canChangeX: false,\n            canChangeY: false,\n            // 改变的基准点\n            changeCropTypeX: 1,\n            changeCropTypeY: 1,\n            // 裁剪框的坐标轴\n            cropX: 0,\n            cropY: 0,\n            cropChangeX: 0,\n            cropChangeY: 0,\n            cropOffsertX: 0,\n            cropOffsertY: 0,\n            // 支持的滚动事件\n            support: '',\n            // 移动端手指缩放\n            touches: [],\n            touchNow: false,\n            // 图片旋转\n            rotate: 0,\n            isIos: false,\n            orientation: 0,\n            imgs: '',\n            // 图片缩放系数\n            coe: 0.2,\n            // 是否正在多次缩放\n            scaling: false,\n            scalingSet: '',\n            coeStatus: ''\n        };\n    },\n    props: {\n        img: {\n            type: String,\n            default: ''\n        },\n        // 输出图片压缩比\n        outputSize: {\n            type: Number,\n            default: 1\n        },\n        outputType: {\n            type: String,\n            default: 'jpeg'\n        },\n        info: {\n            type: Boolean,\n            default: true\n        },\n        // 是否开启滚轮放大缩小\n        canScale: {\n            type: Boolean,\n            default: true\n        },\n        // 是否自成截图框\n        autoCrop: {\n            type: Boolean,\n            default: false\n        },\n        autoCropWidth: {\n            type: Number,\n            default: 0\n        },\n        autoCropHeight: {\n            type: Number,\n            default: 0\n        },\n        // 是否开启固定宽高比\n        fixed: {\n            type: Boolean,\n            default: false\n        },\n        // 宽高比 w/h\n        fixedNumber: {\n            type: Array,\n            default: () => {\n                return [1, 1];\n            }\n        },\n        // 固定大小 禁止改变截图框大小\n        fixedBox: {\n            type: Boolean,\n            default: false\n        },\n        // 输出截图是否缩放\n        full: {\n            type: Boolean,\n            default: false\n        },\n        // 是否可以拖动图片\n        canMove: {\n            type: Boolean,\n            default: true\n        },\n        // 是否可以拖动截图框\n        canMoveBox: {\n            type: Boolean,\n            default: true\n        },\n        // 上传图片按照原始比例显示\n        original: {\n            type: Boolean,\n            default: false\n        }\n    },\n    computed: {\n        cropInfo() {\n            return this.cropOffsertY > 20 ? '-20px' : '0px';\n        }\n    },\n    watch: {\n        // 如果图片改变， 重新布局\n        img() {\n            // 当传入图片时, 读取图片信息同时展示\n            this.checkedImg();\n        },\n        imgs(val) {\n            if (val === '') {\n                return;\n            }\n            this.reload();\n        },\n        cropW() {\n            this.cropW = ~~this.cropW;\n            this.showPreview();\n        },\n        cropH() {\n            this.cropH = ~~this.cropH;\n            this.showPreview();\n        },\n        cropOffsertX() {\n            this.showPreview();\n        },\n        cropOffsertY() {\n            this.showPreview();\n        },\n        scale() {\n            this.showPreview();\n        },\n        x() {\n            this.showPreview();\n        },\n        y() {\n            this.showPreview();\n        },\n        rotate() {\n            this.showPreview();\n        }\n    },\n    methods: {\n        // 校验图片\n        checkedImg() {\n            if (this.img === '') return;\n            this.loading = true;\n            this.scale = 1;\n            this.clearCrop();\n            let canvas = document.createElement('canvas');\n            let img = new Image();\n            let rotate = 0;\n            img.onload = () => {\n                let width = img.width;\n                let height = img.height;\n                let ctx = canvas.getContext('2d');\n                ctx.save();\n                exif.getData(img, () => {\n                    exif.getAllTags(img);\n                    this.orientation = exif.getTag(img, 'Orientation');\n                    switch (this.orientation) {\n                        case 6:\n                            rotate = 1;\n                            break;\n                        case 8:\n                            rotate = -1;\n                            break;\n                        case 3:\n                            rotate = 3;\n                            break;\n                        default:\n                            rotate = 0;\n                    }\n                    if (rotate === 0) {\n                        this.imgs = this.img;\n                        return;\n                    }\n                    switch (rotate) {\n                        case 0:\n                            canvas.width = width;\n                            canvas.height = height;\n                            ctx.drawImage(img, 0, 0, width, height);\n                            break;\n                        case 1:\n                        case -3:\n                            // 旋转90度 或者-270度 宽度和高度对调\n                            canvas.width = height;\n                            canvas.height = width;\n                            ctx.rotate(rotate * 90 * Math.PI / 180);\n                            ctx.drawImage(img, 0, -height, width, height);\n                            break;\n                        case 2:\n                        case -2:\n                            canvas.width = width;\n                            canvas.height = height;\n                            ctx.rotate(rotate * 90 * Math.PI / 180);\n                            ctx.drawImage(img, -width, -height, width, height);\n                            break;\n                        case 3:\n                        case -1:\n                            canvas.width = height;\n                            canvas.height = width;\n                            ctx.rotate(rotate * 90 * Math.PI / 180);\n                            ctx.drawImage(img, -width, 0, width, height);\n                            break;\n                        default:\n                            canvas.width = width;\n                            canvas.height = height;\n                            ctx.drawImage(img, 0, 0, width, height);\n                    }\n                    ctx.restore();\n                    canvas.toBlob(\n                        blob => {\n                            let data = URL.createObjectURL(blob);\n                            this.imgs = data;\n                        },\n                        'image/' + this.outputType,\n                        1\n                    );\n                });\n            };\n            img.onerror = () => {\n                this.$emit('imgLoad', 'error');\n            };\n            img.crossOrigin = '*';\n            img.src = this.img;\n        },\n        // 当按下鼠标键\n        startMove(e) {\n            e.preventDefault();\n            // 如果move 为true 表示当前可以拖动\n            if (this.move && !this.crop) {\n                if (!this.canMove) {\n                    return false;\n                }\n                // 开始移动\n                this.moveX =\n                    (e.clientX ? e.clientX : e.touches[0].clientX) - this.x;\n                this.moveY =\n                    (e.clientY ? e.clientY : e.touches[0].clientY) - this.y;\n                if (e.touches) {\n                    window.addEventListener('touchmove', this.moveImg);\n                    window.addEventListener('touchend', this.leaveImg);\n                    if (e.touches.length == 2) {\n                        // 记录手指刚刚放上去\n                        this.touches = e.touches;\n                        window.addEventListener('touchmove', this.touchScale);\n                        window.addEventListener(\n                            'touchend',\n                            this.cancleTouchScale\n                        );\n                    }\n                } else {\n                    window.addEventListener('mousemove', this.moveImg);\n                    window.addEventListener('mouseup', this.leaveImg);\n                }\n            } else {\n                // 截图ing\n                this.cropping = true;\n                // 绑定截图事件\n                window.addEventListener('mousemove', this.createCrop);\n                window.addEventListener('mouseup', this.endCrop);\n                window.addEventListener('touchmove', this.createCrop);\n                window.addEventListener('touchend', this.endCrop);\n                this.cropOffsertX = e.offsetX ?\n                    e.offsetX :\n                    e.touches[0].pageX - this.$refs.cropper.offsetLeft;\n                this.cropOffsertY = e.offsetY ?\n                    e.offsetY :\n                    e.touches[0].pageY - this.$refs.cropper.offsetTop;\n                this.cropX = e.clientX ? e.clientX : e.touches[0].clientX;\n                this.cropY = e.clientY ? e.clientY : e.touches[0].clientY;\n                this.cropChangeX = this.cropOffsertX;\n                this.cropChangeY = this.cropOffsertY;\n                this.cropW = 0;\n                this.cropH = 0;\n            }\n        },\n\n        // 移动端缩放\n        touchScale(e) {\n            e.preventDefault();\n            // 记录变化量\n            // 第一根手指\n            var oldTouch1 = {\n                x: this.touches[0].clientX,\n                y: this.touches[0].clientY\n            };\n            var newTouch1 = {\n                x: e.touches[0].clientX,\n                y: e.touches[0].clientY\n            };\n            // 第二根手指\n            var oldTouch2 = {\n                x: this.touches[1].clientX,\n                y: this.touches[1].clientY\n            };\n            var newTouch2 = {\n                x: e.touches[1].clientX,\n                y: e.touches[1].clientY\n            };\n            var oldL = Math.sqrt(\n                Math.pow(oldTouch1.x - oldTouch2.x, 2) +\n                Math.pow(oldTouch1.y - oldTouch2.y, 2)\n            );\n            var newL = Math.sqrt(\n                Math.pow(newTouch1.x - newTouch2.x, 2) +\n                Math.pow(newTouch1.y - newTouch2.y, 2)\n            );\n            var cha = ~~(newL - oldL);\n            // 根据图片本身大小 决定每次改变大小的系数, 图片越大系数越小\n            // 1px - 0.2\n            var coe = 1;\n            coe =\n                coe / this.trueWidth > coe / this.trueHeight ?\n                coe / this.trueHeight :\n                coe / this.trueWidth;\n            coe = coe > 0.1 ? 0.1 : coe;\n            var num = coe * cha;\n            if (!this.touchNow) {\n                this.touchNow = true;\n                if (cha > 0) {\n                    this.scale += Math.abs(num);\n                } else if (cha < 0) {\n                    this.scale > Math.abs(num) ?\n                        (this.scale -= Math.abs(num)) :\n                        this.scale;\n                }\n                this.touches = e.touches;\n                setTimeout(() => {\n                    this.touchNow = false;\n                }, 8);\n            }\n        },\n\n        cancleTouchScale(e) {\n            window.removeEventListener('touchmove', this.touchScale);\n        },\n\n        // 移动图片\n        moveImg(e) {\n            e.preventDefault();\n            if (e.touches && e.touches.length === 2) {\n                this.touches = e.touches;\n                window.addEventListener('touchmove', this.touchScale);\n                window.addEventListener('touchend', this.cancleTouchScale);\n                window.removeEventListener('touchmove', this.moveImg);\n                return false;\n            }\n            var nowX = e.clientX ? e.clientX : e.touches[0].clientX;\n            var nowY = e.clientY ? e.clientY : e.touches[0].clientY;\n            this.$nextTick(() => {\n                this.x = ~~(nowX - this.moveX);\n                this.y = ~~(nowY - this.moveY);\n            });\n        },\n        // 移动图片结束\n        leaveImg(e) {\n            window.removeEventListener('mousemove', this.moveImg);\n            window.removeEventListener('touchmove', this.moveImg);\n            window.removeEventListener('mouseup', this.leaveImg);\n            window.removeEventListener('touchend', this.leaveImg);\n        },\n        // 缩放图片\n        scaleImg() {\n            this.support =\n                'onwheel' in document.createElement('div') ?\n                'wheel' :\n                document.onmousewheel !== undefined ?\n                'mousewheel' :\n                'DOMMouseScroll';\n            if (this.canScale) {\n                window.addEventListener(this.support, this.changeSize);\n            }\n        },\n        // 移出框\n        cancleScale() {\n            if (this.canScale) {\n                window.removeEventListener(this.support, this.changeSize);\n            }\n        },\n        // 改变大小函数\n        changeSize(e) {\n            e.preventDefault();\n            var change = e.deltaY || e.wheelDelta;\n            // 根据图片本身大小 决定每次改变大小的系数, 图片越大系数越小\n            var isFirefox = navigator.userAgent.indexOf('Firefox');\n            change = isFirefox > 0 ? change * 30 : change;\n            // 1px - 0.2\n            var coe = this.coe;\n            coe =\n                coe / this.trueWidth > coe / this.trueHeight ?\n                coe / this.trueHeight :\n                coe / this.trueWidth;\n            var num = coe * change;\n            num < 0 ?\n                (this.scale += Math.abs(num)) :\n                this.scale > Math.abs(num) ?\n                (this.scale -= Math.abs(num)) :\n                this.scale;\n            // 延迟0.1s 每次放大大或者缩小的范围\n            let status = num < 0 ? 'add' : 'reduce';\n            if (status !== this.coeStatus) {\n                this.coeStatus = status;\n                this.coe = 0.2;\n            }\n            if (!this.scaling) {\n                this.scalingSet = setTimeout(() => {\n                    this.scaling = false;\n                    this.coe = this.coe += 0.01;\n                }, 50);\n            }\n            this.scaling = true;\n        },\n\n        // 修改图片大小函数\n        changeScale(num) {\n            num = num || 1;\n            var coe = 20;\n            coe =\n                coe / this.trueWidth > coe / this.trueHeight ?\n                coe / this.trueHeight :\n                coe / this.trueWidth;\n            num = num * coe;\n            num > 0 ?\n                (this.scale += Math.abs(num)) :\n                this.scale > Math.abs(num) ?\n                (this.scale -= Math.abs(num)) :\n                this.scale;\n        },\n        // 创建截图框\n        createCrop(e) {\n            e.preventDefault();\n            // 移动生成大小\n            var nowX = e.clientX ?\n                e.clientX :\n                e.touches ? e.touches[0].clientX : 0;\n            var nowY = e.clientY ?\n                e.clientY :\n                e.touches ? e.touches[0].clientY : 0;\n            this.$nextTick(() => {\n                var fw = ~~(nowX - this.cropX);\n                var fh = ~~(nowY - this.cropY);\n                if (fw > 0) {\n                    this.cropW =\n                        fw + this.cropChangeX > this.w ?\n                        this.w - this.cropChangeX :\n                        fw;\n                    this.cropOffsertX = this.cropChangeX;\n                } else {\n                    this.cropW =\n                        this.w - this.cropChangeX + Math.abs(fw) > this.w ?\n                        this.cropChangeX :\n                        Math.abs(fw);\n                    this.cropOffsertX =\n                        this.cropChangeX + fw > 0 ? this.cropChangeX + fw : 0;\n                }\n\n                if (!this.fixed) {\n                    if (fh > 0) {\n                        this.cropH =\n                            fh + this.cropChangeY > this.h ?\n                            this.h - this.cropChangeY :\n                            fh;\n                        this.cropOffsertY = this.cropChangeY;\n                    } else {\n                        this.cropH =\n                            this.h - this.cropChangeY + Math.abs(fh) > this.h ?\n                            this.cropChangeY :\n                            Math.abs(fh);\n                        this.cropOffsertY =\n                            this.cropChangeY + fh > 0 ?\n                            this.cropChangeY + fh :\n                            0;\n                    }\n                } else {\n                    var fixedHeight = ~~(\n                        this.cropW /\n                        this.fixedNumber[0] *\n                        this.fixedNumber[1]\n                    );\n                    if (fixedHeight + this.cropOffsertY > this.h) {\n                        this.cropH = this.h - this.cropOffsertY;\n                        this.cropW = ~~(\n                            this.cropH /\n                            this.fixedNumber[1] *\n                            this.fixedNumber[0]\n                        );\n                        if (fw > 0) {\n                            this.cropOffsertX = this.cropChangeX;\n                        } else {\n                            this.cropOffsertX = this.cropChangeX - this.cropW;\n                        }\n                    } else {\n                        this.cropH = fixedHeight;\n                    }\n                    this.cropOffsertY = this.cropOffsertY;\n                }\n            });\n        },\n\n        // 改变截图框大小\n        changeCropSize(e, w, h, typeW, typeH) {\n            e.preventDefault();\n            window.addEventListener('mousemove', this.changeCropNow);\n            window.addEventListener('mouseup', this.changeCropEnd);\n            window.addEventListener('touchmove', this.changeCropNow);\n            window.addEventListener('touchend', this.changeCropEnd);\n            this.canChangeX = w;\n            this.canChangeY = h;\n            this.changeCropTypeX = typeW;\n            this.changeCropTypeY = typeH;\n            this.cropX = e.clientX ? e.clientX : e.touches[0].clientX;\n            this.cropY = e.clientY ? e.clientY : e.touches[0].clientY;\n            this.cropOldW = this.cropW;\n            this.cropOldH = this.cropH;\n            this.cropChangeX = this.cropOffsertX;\n            this.cropChangeY = this.cropOffsertY;\n            if (this.fixed) {\n                if (this.canChangeX && this.canChangeY) {\n                    this.canChangeY = 0;\n                }\n            }\n        },\n\n        // 正在改变\n        changeCropNow(e) {\n            e.preventDefault();\n            var nowX = e.clientX ?\n                e.clientX :\n                e.touches ? e.touches[0].clientX : 0;\n            var nowY = e.clientY ?\n                e.clientY :\n                e.touches ? e.touches[0].clientY : 0;\n            this.$nextTick(() => {\n                var fw = ~~(nowX - this.cropX);\n                var fh = ~~(nowY - this.cropY);\n                if (this.canChangeX) {\n                    if (this.changeCropTypeX === 1) {\n                        if (this.cropOldW - fw > 0) {\n                            this.cropW =\n                                this.w - this.cropChangeX - fw <= this.w ?\n                                this.cropOldW - fw :\n                                this.cropOldW + this.cropChangeX;\n                            this.cropOffsertX =\n                                this.w - this.cropChangeX - fw <= this.w ?\n                                this.cropChangeX + fw :\n                                0;\n                        } else {\n                            this.cropW =\n                                Math.abs(fw) + this.cropChangeX <= this.w ?\n                                Math.abs(fw) - this.cropOldW :\n                                this.w - this.cropOldW - this.cropChangeX;\n                            this.cropOffsertX =\n                                this.cropChangeX + this.cropOldW;\n                        }\n                    } else if (this.changeCropTypeX === 2) {\n                        if (this.cropOldW + fw > 0) {\n                            this.cropW =\n                                this.cropOldW + fw + this.cropOffsertX <= this.w ?\n                                this.cropOldW + fw :\n                                this.w - this.cropOffsertX;\n                            this.cropOffsertX = this.cropChangeX;\n                        } else {\n                            this.cropW =\n                                this.w -\n                                this.cropChangeX +\n                                Math.abs(fw + this.cropOldW) <=\n                                this.w ?\n                                Math.abs(fw + this.cropOldW) :\n                                this.cropChangeX;\n                            this.cropOffsertX =\n                                this.w -\n                                this.cropChangeX +\n                                Math.abs(fw + this.cropOldW) <=\n                                this.w ?\n                                this.cropChangeX -\n                                Math.abs(fw + this.cropOldW) :\n                                0;\n                        }\n                    }\n                }\n\n                if (this.canChangeY) {\n                    if (this.changeCropTypeY === 1) {\n                        if (this.cropOldH - fh > 0) {\n                            this.cropH =\n                                this.h - this.cropChangeY - fh <= this.h ?\n                                this.cropOldH - fh :\n                                this.cropOldH + this.cropChangeY;\n                            this.cropOffsertY =\n                                this.h - this.cropChangeY - fh <= this.h ?\n                                this.cropChangeY + fh :\n                                0;\n                        } else {\n                            this.cropH =\n                                Math.abs(fh) + this.cropChangeY <= this.h ?\n                                Math.abs(fh) - this.cropOldH :\n                                this.h - this.cropOldH - this.cropChangeY;\n                            this.cropOffsertY =\n                                this.cropChangeY + this.cropOldH;\n                        }\n                    } else if (this.changeCropTypeY === 2) {\n                        if (this.cropOldH + fh > 0) {\n                            this.cropH =\n                                this.cropOldH + fh + this.cropOffsertY <= this.h ?\n                                this.cropOldH + fh :\n                                this.h - this.cropOffsertY;\n                            this.cropOffsertY = this.cropChangeY;\n                        } else {\n                            this.cropH =\n                                this.h -\n                                this.cropChangeY +\n                                Math.abs(fh + this.cropOldH) <=\n                                this.h ?\n                                Math.abs(fh + this.cropOldH) :\n                                this.cropChangeY;\n                            this.cropOffsertY =\n                                this.h -\n                                this.cropChangeY +\n                                Math.abs(fh + this.cropOldH) <=\n                                this.h ?\n                                this.cropChangeY -\n                                Math.abs(fh + this.cropOldH) :\n                                0;\n                        }\n                    }\n                }\n\n                if (this.canChangeX && this.fixed) {\n                    var fixedHeight = ~~(\n                        this.cropW /\n                        this.fixedNumber[0] *\n                        this.fixedNumber[1]\n                    );\n                    if (fixedHeight + this.cropOffsertY > this.h) {\n                        this.cropH = this.h - this.cropOffsertY;\n                        this.cropW = ~~(\n                            this.cropH /\n                            this.fixedNumber[1] *\n                            this.fixedNumber[0]\n                        );\n                    } else {\n                        this.cropH = fixedHeight;\n                    }\n                }\n\n                if (this.canChangeY && this.fixed) {\n                    var fixedWidth = ~~(\n                        this.cropH /\n                        this.fixedNumber[1] *\n                        this.fixedNumber[0]\n                    );\n                    if (fixedWidth + this.cropOffsertX > this.w) {\n                        this.cropW = this.w - this.cropOffsertX;\n                        this.cropH = ~~(\n                            this.cropW /\n                            this.fixedNumber[0] *\n                            this.fixedNumber[1]\n                        );\n                    } else {\n                        this.cropW = fixedWidth;\n                    }\n                }\n            });\n        },\n\n        // 结束改变\n        changeCropEnd(e) {\n            window.removeEventListener('mousemove', this.changeCropNow);\n            window.removeEventListener('mouseup', this.changeCropEnd);\n            window.removeEventListener('touchmove', this.changeCropNow);\n            window.removeEventListener('touchend', this.changeCropEnd);\n        },\n\n        // 创建完成\n        endCrop() {\n            if (this.cropW === 0 && this.cropH === 0) {\n                this.cropping = false;\n            }\n            window.removeEventListener('mousemove', this.createCrop);\n            window.removeEventListener('mouseup', this.endCrop);\n            window.removeEventListener('touchmove', this.createCrop);\n            window.removeEventListener('touchend', this.endCrop);\n        },\n        // 开始截图\n        startCrop() {\n            this.crop = true;\n            // console.log('开始截图')\n        },\n        // 停止截图\n        stopCrop() {\n            this.crop = false;\n            // console.log('停止截图')\n        },\n        // 清除截图\n        clearCrop() {\n            this.cropping = false;\n            this.cropW = 0;\n            this.cropH = 0;\n            // console.log('清除截图')\n        },\n        // 截图移动\n        cropMove(e) {\n            e.preventDefault();\n            if (!this.canMoveBox) {\n                this.crop = false;\n                this.startMove(e);\n                return false;\n            }\n            window.addEventListener('mousemove', this.moveCrop);\n            window.addEventListener('mouseup', this.leaveCrop);\n            window.addEventListener('touchmove', this.moveCrop);\n            window.addEventListener('touchend', this.leaveCrop);\n            this.cropX =\n                (e.clientX ? e.clientX : e.touches[0].clientX) -\n                this.cropOffsertX;\n            this.cropY =\n                (e.clientY ? e.clientY : e.touches[0].clientY) -\n                this.cropOffsertY;\n        },\n\n        moveCrop(e) {\n            e.preventDefault();\n            var nowX = e.clientX ? e.clientX : e.touches[0].clientX;\n            var nowY = e.clientY ? e.clientY : e.touches[0].clientY;\n            this.$nextTick(() => {\n                var fw = ~~(nowX - this.cropX);\n                var fh = ~~(nowY - this.cropY);\n                if (fw <= 1) {\n                    this.cropOffsertX = 1;\n                } else if (~~(fw + this.cropW) > this.w) {\n                    this.cropOffsertX = this.w - this.cropW - 1;\n                } else {\n                    this.cropOffsertX = fw;\n                }\n\n                if (fh <= 1) {\n                    this.cropOffsertY = 1;\n                } else if (~~(fh + this.cropH) > this.h) {\n                    this.cropOffsertY = this.h - this.cropH - 1;\n                } else {\n                    this.cropOffsertY = fh;\n                }\n            });\n        },\n\n        leaveCrop(e) {\n            window.removeEventListener('mousemove', this.moveCrop);\n            window.removeEventListener('mouseup', this.leaveCrop);\n            window.removeEventListener('touchmove', this.moveCrop);\n            window.removeEventListener('touchend', this.leaveCrop);\n        },\n        // 获取转换成base64 的图片信息\n        getCropData(cb) {\n            let canvas = document.createElement('canvas');\n            let img = new Image();\n            let rotate = this.rotate;\n            let trueWidth = this.trueWidth;\n            let trueHeight = this.trueHeight;\n            let cropOffsertX = this.cropOffsertX;\n            let cropOffsertY = this.cropOffsertY;\n            img.onload = () => {\n                if (~~this.cropW !== 0) {\n                    let ctx = canvas.getContext('2d');\n                    let width = this.cropW;\n                    let height = this.cropH;\n                    let imgW = trueWidth * this.scale;\n                    let imgH = trueHeight * this.scale;\n                    // 图片x轴偏移\n                    let dx =\n                        this.x -\n                        cropOffsertX +\n                        this.trueWidth * (1 - this.scale) / 2;\n                    // 图片y轴偏移\n                    let dy =\n                        this.y -\n                        cropOffsertY +\n                        this.trueHeight * (1 - this.scale) / 2;\n                    // console.log(dx, dy)\n                    // 保存状态\n                    canvas.width = width;\n                    canvas.height = height;\n                    ctx.save();\n                    switch (rotate) {\n                        case 0:\n                            if (!this.full) {\n                                ctx.drawImage(img, dx, dy, imgW, imgH);\n                            } else {\n                                // 输出原图比例截图\n                                canvas.width = width / this.scale;\n                                canvas.height = height / this.scale;\n                                ctx.drawImage(\n                                    img,\n                                    dx / this.scale,\n                                    dy / this.scale,\n                                    imgW / this.scale,\n                                    imgH / this.scale\n                                );\n                            }\n                            break;\n                        case 1:\n                        case -3:\n                            if (!this.full) {\n                                // 换算图片旋转后的坐标弥补\n                                dx = dx + (imgW - imgH) / 2;\n                                dy = dy + (imgH - imgW) / 2;\n                                ctx.rotate(rotate * 90 * Math.PI / 180);\n                                ctx.drawImage(img, dy, -dx - imgH, imgW, imgH);\n                            } else {\n                                canvas.width = width / this.scale;\n                                canvas.height = height / this.scale;\n                                // 换算图片旋转后的坐标弥补\n                                dx =\n                                    dx / this.scale +\n                                    (imgW / this.scale - imgH / this.scale) / 2;\n                                dy =\n                                    dy / this.scale +\n                                    (imgH / this.scale - imgW / this.scale) / 2;\n                                ctx.rotate(rotate * 90 * Math.PI / 180);\n                                ctx.drawImage(\n                                    img,\n                                    dy, -dx - imgH / this.scale,\n                                    imgW / this.scale,\n                                    imgH / this.scale\n                                );\n                            }\n                            break;\n                        case 2:\n                        case -2:\n                            if (!this.full) {\n                                ctx.rotate(rotate * 90 * Math.PI / 180);\n                                ctx.drawImage(\n                                    img, -dx - imgW, -dy - imgH,\n                                    imgW,\n                                    imgH\n                                );\n                            } else {\n                                canvas.width = width / this.scale;\n                                canvas.height = height / this.scale;\n                                ctx.rotate(rotate * 90 * Math.PI / 180);\n                                dx = dx / this.scale;\n                                dy = dy / this.scale;\n                                ctx.drawImage(\n                                    img, -dx - imgW / this.scale, -dy - imgH / this.scale,\n                                    imgW / this.scale,\n                                    imgH / this.scale\n                                );\n                            }\n                            break;\n                        case 3:\n                        case -1:\n                            if (!this.full) {\n                                // 换算图片旋转后的坐标弥补\n                                dx = dx + (imgW - imgH) / 2;\n                                dy = dy + (imgH - imgW) / 2;\n                                ctx.rotate(rotate * 90 * Math.PI / 180);\n                                ctx.drawImage(img, -dy - imgW, dx, imgW, imgH);\n                            } else {\n                                canvas.width = width / this.scale;\n                                canvas.height = height / this.scale;\n                                // 换算图片旋转后的坐标弥补\n                                dx =\n                                    dx / this.scale +\n                                    (imgW / this.scale - imgH / this.scale) / 2;\n                                dy =\n                                    dy / this.scale +\n                                    (imgH / this.scale - imgW / this.scale) / 2;\n                                ctx.rotate(rotate * 90 * Math.PI / 180);\n                                ctx.drawImage(\n                                    img, -dy - imgW / this.scale,\n                                    dx,\n                                    imgW / this.scale,\n                                    imgH / this.scale\n                                );\n                            }\n                            break;\n                        default:\n                            if (!this.full) {\n                                ctx.drawImage(img, dx, dy, imgW, imgH);\n                            } else {\n                                // 输出原图比例截图\n                                canvas.width = width / this.scale;\n                                canvas.height = height / this.scale;\n                                ctx.drawImage(\n                                    img,\n                                    dx / this.scale,\n                                    dy / this.scale,\n                                    imgW / this.scale,\n                                    imgH / this.scale\n                                );\n                            }\n                    }\n                    ctx.restore();\n                } else {\n                    let width = trueWidth * this.scale;\n                    let height = trueHeight * this.scale;\n                    let ctx = canvas.getContext('2d');\n                    ctx.save();\n                    switch (rotate) {\n                        case 0:\n                            canvas.width = width;\n                            canvas.height = height;\n                            ctx.drawImage(img, 0, 0, width, height);\n                            break;\n                        case 1:\n                        case -3:\n                            // 旋转90度 或者-270度 宽度和高度对调\n                            canvas.width = height;\n                            canvas.height = width;\n                            ctx.rotate(rotate * 90 * Math.PI / 180);\n                            ctx.drawImage(img, 0, -height, width, height);\n                            break;\n                        case 2:\n                        case -2:\n                            canvas.width = width;\n                            canvas.height = height;\n                            ctx.rotate(rotate * 90 * Math.PI / 180);\n                            ctx.drawImage(img, -width, -height, width, height);\n                            break;\n                        case 3:\n                        case -1:\n                            canvas.width = height;\n                            canvas.height = width;\n                            ctx.rotate(rotate * 90 * Math.PI / 180);\n                            ctx.drawImage(img, -width, 0, width, height);\n                            break;\n                        default:\n                            canvas.width = width;\n                            canvas.height = height;\n                            ctx.drawImage(img, 0, 0, width, height);\n                    }\n                    ctx.restore();\n                }\n                let data = canvas.toDataURL(\n                    'image/' + this.outputType,\n                    this.outputSize\n                );\n                cb(data);\n            };\n            // 判断图片是否是base64\n            var s = this.img.substr(0, 4);\n            if (s !== 'data') {\n                img.crossOrigin = 'anonymous';\n            }\n            img.src = this.imgs;\n        },\n        // 转化base64 为blob对象\n        getCropBlob(cb) {\n            this.getCropData(data => {\n                var arr = data.split(',');\n                var mime = arr[0].match(/:(.*?);/)[1];\n                var bstr = atob(arr[1]);\n                var n = bstr.length;\n                var u8arr = new Uint8Array(n);\n                while (n--) {\n                    u8arr[n] = bstr.charCodeAt(n);\n                }\n                cb(\n                    new Blob([u8arr], {\n                        type: mime\n                    })\n                );\n            });\n        },\n\n        // 自动预览函数\n        showPreview() {\n            var obj = {};\n            obj.div = {\n                width: this.cropW + 'px',\n                height: this.cropH + 'px'\n            };\n            obj.img = {\n                width: this.trueWidth + 'px',\n                height: this.trueHeight + 'px',\n                transform: 'scale(' +\n                    this.scale +\n                    ',' +\n                    this.scale +\n                    ') ' +\n                    'translate3d(' +\n                    (this.x - this.cropOffsertX) / this.scale +\n                    'px,' +\n                    (this.y - this.cropOffsertY) / this.scale +\n                    'px,' +\n                    '0)' +\n                    'rotateZ(' +\n                    this.rotate * 90 +\n                    'deg)'\n            };\n            obj.w = this.cropW;\n            obj.h = this.cropH;\n            obj.url = this.imgs;\n            this.$emit('realTime', obj);\n        },\n        // reload 图片布局函数\n        reload() {\n            let img = new Image();\n            img.onload = () => {\n                // 读取图片的信息原始信息， 解析是否需要旋转\n                // 读取图片的旋转信息\n                // 得到外层容器的宽度高度\n                this.w = ~~window\n                    .getComputedStyle(this.$refs.cropper)\n                    .width.replace('px', '');\n                this.h = ~~window\n                    .getComputedStyle(this.$refs.cropper)\n                    .height.replace('px', '');\n\n                // 存入图片真实高度\n                this.trueWidth = img.width;\n                this.trueHeight = img.height;\n\n                // 判断是否需要压缩大图\n                if (!this.original) {\n                    if (this.trueWidth > this.w) {\n                        // 如果图片宽度大于容器宽度\n                        this.scale = this.w / this.trueWidth;\n                    }\n\n                    if (this.trueHeight * this.scale > this.h) {\n                        this.scale = this.h / this.trueHeight;\n                    }\n                } else {\n                    this.scale = 1;\n                }\n\n                this.$nextTick(() => {\n                    this.x = -(this.trueWidth - this.trueWidth * this.scale) / 2 +\n                        (this.w - this.trueWidth * this.scale) / 2;\n                    this.y = -(this.trueHeight - this.trueHeight * this.scale) / 2 +\n                        (this.h - this.trueHeight * this.scale) / 2;\n                    this.loading = false;\n                    // 获取是否开启了自动截图\n                    if (this.autoCrop) {\n                        this.goAutoCrop();\n                    }\n                    // 图片加载成功的回调\n                    this.$emit('imgLoad', 'success');\n                });\n            };\n            img.onerror = () => {\n                this.$emit('imgLoad', 'error');\n            };\n            img.src = this.imgs;\n        },\n        // 自动截图函数\n        goAutoCrop() {\n            this.cropping = true;\n            // 截图框默认大小\n            // 如果为0 那么计算容器大小 默认为80%\n            var w = this.autoCropWidth;\n            var h = this.autoCropHeight;\n            if (w === 0 || h === 0) {\n                w = this.w * 0.8;\n                h = this.h * 0.8;\n            }\n            w = w > this.w ? this.w : w;\n            h = h > this.h ? this.h : h;\n            if (this.fixed) {\n                h = w / this.fixedNumber[0] * this.fixedNumber[1];\n            }\n            // 如果比例之后 高度大于h\n            if (h > this.h) {\n                h = this.h;\n                w = h / this.fixedNumber[1] * this.fixedNumber[0];\n            }\n            this.changeCrop(w, h);\n        },\n        // 手动改变截图框大小函数\n        changeCrop(w, h) {\n            // 判断是否大于容器\n            this.cropW = w;\n            this.cropH = h;\n            // 居中走一走\n            this.cropOffsertX = (this.w - w) / 2;\n            this.cropOffsertY = (this.h - h) / 2;\n        },\n        // 重置函数， 恢复组件置初始状态\n        refresh() {\n            // console.log('refresh')\n            this.imgs = '';\n            this.scale = 1;\n            this.crop = false;\n            this.rotate = 0;\n            this.w = 0;\n            this.h = 0;\n            this.trueWidth = 0;\n            this.trueHeight = 0;\n            this.clearCrop();\n        },\n\n        // 向左边旋转\n        rotateLeft() {\n            this.rotate = this.rotate <= -3 ? 0 : this.rotate - 1;\n        },\n\n        // 向右边旋转\n        rotateRight() {\n            this.rotate = this.rotate >= 3 ? 0 : this.rotate + 1;\n        },\n\n        // 清除旋转\n        rotateClear() {\n            this.rotate = 0;\n        }\n    },\n    mounted() {\n        let that = this;\n        this.showPreview();\n        this.checkedImg();\n        var u = navigator.userAgent;\n        this.isIOS = !!u.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/);\n        // 兼容blob\n        if (!HTMLCanvasElement.prototype.toBlob) {\n            Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\n                value: function(callback, type, quality) {\n                    var binStr = atob(\n                            this.toDataURL(type, quality).split(',')[1]\n                        ),\n                        len = binStr.length,\n                        arr = new Uint8Array(len);\n                    for (var i = 0; i < len; i++) {\n                        arr[i] = binStr.charCodeAt(i);\n                    }\n                    callback(\n                        new Blob([arr], { type: that.type || 'image/png' })\n                    );\n                }\n            });\n        }\n    }\n};\n\n</script>\n<style>\n.vue-cropper {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    box-sizing: border-box;\n    user-select: none;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    direction: ltr;\n    touch-action: none;\n    background-color: #000;\n    /* background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC'); */\n}\n\n.cropper-box,\n.cropper-box-canvas,\n.cropper-drag-box,\n.cropper-crop-box,\n.cropper-face {\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    user-select: none;\n}\n\n.cropper-box-canvas img {\n    position: relative;\n    user-select: none;\n    transform: none;\n    max-width: none;\n    max-height: none;\n}\n\n.cropper-box {\n    overflow: hidden;\n}\n\n.cropper-move {\n    cursor: move;\n}\n\n.cropper-crop {\n    cursor: crosshair;\n}\n\n.cropper-modal {\n    background: rgba(0, 0, 0, 0.5);\n}\n\n.cropper-crop-box {\n    /*border: 2px solid #44a870;*/\n}\n\n.cropper-view-box {\n    display: block;\n    overflow: hidden;\n    width: 100%;\n    height: 100%;\n    outline: 1px solid #44a870;\n    outline-color: #44a870;\n    user-select: none;\n}\n\n.cropper-view-box img {\n    user-select: none;\n    max-width: none;\n    max-height: none;\n}\n\n.cropper-face {\n    top: 0;\n    left: 0;\n    background-color: #fff;\n    opacity: 0.1;\n}\n\n.crop-info {\n    position: absolute;\n    left: 0px;\n    min-width: 65px;\n    text-align: center;\n    color: white;\n    line-height: 20px;\n    background-color: rgba(0, 0, 0, 0.8);\n    font-size: 12px;\n}\n\n.crop-line {\n    position: absolute;\n    display: block;\n    width: 100%;\n    height: 100%;\n    opacity: .1;\n}\n\n.line-w {\n    top: -3px;\n    left: 0;\n    height: 5px;\n    cursor: n-resize;\n}\n\n.line-a {\n    top: 0;\n    left: -3px;\n    width: 5px;\n    cursor: w-resize;\n}\n\n.line-s {\n    bottom: -3px;\n    left: 0;\n    height: 5px;\n    cursor: s-resize;\n}\n\n.line-d {\n    top: 0;\n    right: -3px;\n    width: 5px;\n    cursor: e-resize;\n}\n\n.crop-point {\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    opacity: .75;\n    background-color: #44a870;\n    border-radius: 100%;\n}\n\n.point1 {\n    top: -4px;\n    left: -4px;\n    cursor: nw-resize;\n}\n\n.point2 {\n    top: -5px;\n    left: 50%;\n    margin-left: -3px;\n    cursor: n-resize;\n}\n\n.point3 {\n    top: -4px;\n    right: -4px;\n    cursor: ne-resize;\n}\n\n.point4 {\n    top: 50%;\n    left: -4px;\n    margin-top: -3px;\n    cursor: w-resize;\n}\n\n.point5 {\n    top: 50%;\n    right: -4px;\n    margin-top: -3px;\n    cursor: w-resize;\n}\n\n.point6 {\n    bottom: -5px;\n    left: -4px;\n    cursor: sw-resize;\n}\n\n.point7 {\n    bottom: -5px;\n    left: 50%;\n    margin-left: -3px;\n    cursor: s-resize;\n}\n\n.point8 {\n    bottom: -5px;\n    right: -4px;\n    cursor: nw-resize;\n}\n\n@media screen and (max-width: 500px) {\n    .crop-point {\n        position: absolute;\n        width: 20px;\n        height: 20px;\n        opacity: .45;\n        background-color: #44a870;\n        border-radius: 100%;\n    }\n\n    .point1 {\n        top: -10px;\n        left: -10px;\n    }\n\n    .point2,\n    .point4,\n    .point5,\n    .point7 {\n        display: none;\n    }\n\n    .point3 {\n        top: -10px;\n        right: -10px;\n    }\n\n    .point4 {\n        top: 0;\n        left: 0;\n    }\n\n    .point6 {\n        bottom: -10px;\n        left: -10px;\n    }\n\n    .point8 {\n        bottom: -10px;\n        right: -10px;\n    }\n}\n\n</style>\n"]}]}