{"remainingRequest":"/Users/yoon/jz-video/node_modules/babel-loader/lib/index.js!/Users/yoon/jz-video/node_modules/eslint-loader/index.js??ref--13-0!/Users/yoon/jz-video/src/service/base/clipper.js","dependencies":[{"path":"/Users/yoon/jz-video/src/service/base/clipper.js","mtime":1582724575792},{"path":"/Users/yoon/jz-video/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yoon/jz-video/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yoon/jz-video/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsbCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwiOwoKLyoqDQogKgluYW1lIDogdnVlIOeahOWbvueJh+ijgeWHj+WOi+e8qeWkhOeQhg0KICogICBkZXBlbmRlbmNlIDoNCiAqICAgICAgIGNyb3BwZXIg56ys5LiJ5pa555qE5LiA5Liq6KOB5Ymq5bqTDQogKiAgICAgICBleGlmICAgIOiOt+WPluWbvueJh+a6kOS/oeaBr++8jOino+WGs2lvc+WbvueJh+aXi+i9rOeahOmXrumimA0KICogKi8KaW1wb3J0IENyb3BwZXIgZnJvbSAnY3JvcHBlcmpzJzsKaW1wb3J0IEV4aWYgZnJvbSAnZXhpZi1qcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBpbnN0YWxsOiBmdW5jdGlvbiBpbnN0YWxsKFZ1ZSkgewogICAgLy/liJ3lp4vljJbmlrnms5UKICAgIFZ1ZS5wcm90b3R5cGUuaW5pdGlsaXplID0gZnVuY3Rpb24gKG9wdCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHRoaXMub3B0aW9ucyA9IG9wdDsgLy/liJvlu7pkb20KCiAgICAgIHRoaXMuY3JlYXRlRWxlbWVudCgpOwogICAgICB0aGlzLnJlc3VsdE9iaiA9IG9wdC5yZXN1bHRPYmo7IC8v5Yid5aeL5YyW6KOB5Ymq5a+56LGhCgogICAgICB0aGlzLmNyb3BwZXIgPSBuZXcgQ3JvcHBlcih0aGlzLnByZXZpZXcsIHsKICAgICAgICBhc3BlY3RSYXRpbzogb3B0LmFzcGVjdFJhdGlvIHx8IDEsCiAgICAgICAgYXV0b0Nyb3BBcmVhOiBvcHQuYXV0b0Nyb3BBcmVhIHx8IDAuOCwKICAgICAgICB2aWV3TW9kZTogMSwKICAgICAgICBndWlkZXM6IG9wdC5hc3BlY3RSYXRpbyA9PSAnRnJlZScgPyBmYWxzZSA6IHRydWUsCiAgICAgICAgY3JvcEJveFJlc2l6YWJsZTogb3B0LmFzcGVjdFJhdGlvID09ICdGcmVlJyA/IGZhbHNlIDogdHJ1ZSwKICAgICAgICBjcm9wQm94TW92YWJsZTogb3B0LmFzcGVjdFJhdGlvID09ICdGcmVlJyA/IGZhbHNlIDogdHJ1ZSwKICAgICAgICBkcmFnQ3JvcDogb3B0LmFzcGVjdFJhdGlvID09ICdGcmVlJyA/IGZhbHNlIDogdHJ1ZSwKICAgICAgICBiYWNrZ3JvdW5kOiBmYWxzZSwKICAgICAgICBjaGVja09yaWVudGF0aW9uOiB0cnVlLAogICAgICAgIGNoZWNrQ3Jvc3NPcmlnaW46IHRydWUsCiAgICAgICAgem9vbWFibGU6IGZhbHNlLAogICAgICAgIHpvb21PbldoZWVsOiBmYWxzZSwKICAgICAgICBjZW50ZXI6IGZhbHNlLAogICAgICAgIHRvZ2dsZURyYWdNb2RlT25EYmxjbGljazogZmFsc2UsCiAgICAgICAgcmVhZHk6IGZ1bmN0aW9uIHJlYWR5KCkgewogICAgICAgICAgLy8gY29uc29sZS5sb2coc2VsZi5jcm9wcGVyLnJvdGF0ZSg5MCkpCiAgICAgICAgICBpZiAob3B0LmFzcGVjdFJhdGlvID09ICdGcmVlJykgewogICAgICAgICAgICB2YXIgY3JvcEJveCA9IHNlbGYuY3JvcHBlci5jcm9wQm94OwogICAgICAgICAgICBjcm9wQm94LnF1ZXJ5U2VsZWN0b3IoJ3NwYW4uY3JvcHBlci12aWV3LWJveCcpLnN0eWxlLm91dGxpbmUgPSAnbm9uZSc7CiAgICAgICAgICAgIHNlbGYuY3JvcHBlci5kaXNhYmxlKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH07IC8v5Yib5bu65LiA5Lqb5b+F6KaB55qERE9N77yM55So5LqO5Zu+54mH6KOB5YmqCgoKICAgIFZ1ZS5wcm90b3R5cGUuY3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgLy/liJ3lp4vljJblm77niYfkuLrnqbrlr7nosaEKICAgICAgdGhpcy5wcmV2aWV3ID0gbnVsbDsKICAgICAgdmFyIHN0ciA9ICc8ZGl2PjxpbWcgaWQ9ImNsaXBfaW1hZ2UiIHNyYz0ib3JpZ2luVXJsIj48L2Rpdj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImNhbmNlbF9jbGlwIj7lj5bmtog8L2J1dHRvbj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImNsaXBfYnV0dG9uIj7noa7lrpo8L2J1dHRvbj4nOwogICAgICB2YXIgYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07CiAgICAgIHRoaXMucmVhZ2lvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICB0aGlzLnJlYWdpb24uaWQgPSAnY2xpcF9jb250YWluZXInOwogICAgICB0aGlzLnJlYWdpb24uY2xhc3NOYW1lID0gJ2NvbnRhaW5lcic7CiAgICAgIHRoaXMucmVhZ2lvbi5pbm5lckhUTUwgPSBzdHI7IC8v5re75Yqg5Yib5bu65aW955qERE9N5YWD57SgCgogICAgICBib2R5LmFwcGVuZENoaWxkKHRoaXMucmVhZ2lvbik7CiAgICAgIHRoaXMucHJldmlldyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGlwX2ltYWdlJyk7IC8v57uR5a6a5LiA5Lqb5pa55rOVCgogICAgICB0aGlzLmluaXRGdW5jdGlvbigpOwogICAgfTsgLy/liJ3lp4vljJbkuIDkupvlh73mlbDnu5HlrpoKCgogICAgVnVlLnByb3RvdHlwZS5pbml0RnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdGhpcy5jbGlja0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGlwX2J1dHRvbicpOwogICAgICB0aGlzLmNhbmNlbEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5jZWxfY2xpcCcpOyAvL+ehruWumuS6i+S7tgoKICAgICAgdGhpcy5hZGRFdmVudCh0aGlzLmNsaWNrQnRuLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgc2VsZi5jcm9wKCk7CiAgICAgIH0pOyAvL+WPlua2iOS6i+S7tgoKICAgICAgdGhpcy5hZGRFdmVudCh0aGlzLmNhbmNlbEJ0biwgJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgIHNlbGYuZGVzdG9yaWVkKCk7CiAgICAgIH0pOyAvL+a4heepumlucHV055qE5YC8CgogICAgICB0aGlzLmFkZEV2ZW50KHRoaXMuZmlsZU9iaiwgJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMudmFsdWUgPSAnJzsKICAgICAgfSk7CiAgICB9OyAvL+WklumDqOaOpeWPo++8jOeUqOS6jmlucHV0WydmaWxlJ13lr7nosaFjaGFuZ2Xml7bnmoTosIPnlKgKCgogICAgVnVlLnByb3RvdHlwZS5jbGlwID0gZnVuY3Rpb24gKGUsIG9wdCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHRoaXMuZmlsZU9iaiA9IGUuc3JjRWxlbWVudDsKICAgICAgdmFyIGZpbGVzID0gZS50YXJnZXQuZmlsZXMgfHwgZS5kYXRhVHJhbnNmZXIuZmlsZXM7CiAgICAgIGlmICghZmlsZXMubGVuZ3RoKSByZXR1cm4gZmFsc2U7IC8v5LiN5piv5Zu+54mH55u05o6l6L+U5ZueCiAgICAgIC8v6LCD55So5Yid5aeL5YyW5pa55rOVCgogICAgICB0aGlzLmluaXRpbGl6ZShvcHQpOyAvL+iOt+WPluWbvueJh+aWh+S7tui1hOa6kAoKICAgICAgdGhpcy5waWNWYWx1ZSA9IGZpbGVzWzBdOyAvL+WOu+iOt+WPluaLjeeFp+aXtueahOS/oeaBr++8jOino+WGs+aLjeWHuuadpeeahOeFp+eJh+aXi+i9rOmXrumimAoKICAgICAgRXhpZi5nZXREYXRhKGZpbGVzWzBdLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgc2VsZi5PcmllbnRhdGlvbiA9IEV4aWYuZ2V0VGFnKGZpbGVzWzBdLCAnT3JpZW50YXRpb24nKTsKICAgICAgICBjb25zb2xlLmxvZyhzZWxmLk9yaWVudGF0aW9uKTsKICAgICAgfSk7IC8v6LCD55So5pa55rOV6L2s5oiQdXJs5qC85byPCgogICAgICB0aGlzLm9yaWdpblVybCA9IHRoaXMuZ2V0T2JqZWN0VVJMKHRoaXMucGljVmFsdWUpOyAvL+avj+asoeabv+aNouWbvueJh+imgemHjeaWsOW+l+WIsOaWsOeahHVybAoKICAgICAgaWYgKHRoaXMuY3JvcHBlcikgewogICAgICAgIHRoaXMuY3JvcHBlci5yZXBsYWNlKHRoaXMub3JpZ2luVXJsKTsKICAgICAgfQogICAgfTsgLy/lm77niYfovaznoIHmlrnms5UKCgogICAgVnVlLnByb3RvdHlwZS5nZXRPYmplY3RVUkwgPSBmdW5jdGlvbiAoZmlsZSkgewogICAgICB2YXIgdXJsID0gbnVsbDsKCiAgICAgIGlmICh3aW5kb3cuY3JlYXRlT2JqZWN0VVJMICE9IHVuZGVmaW5lZCkgewogICAgICAgIC8vIGJhc2ljCiAgICAgICAgdXJsID0gd2luZG93LmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgfSBlbHNlIGlmICh3aW5kb3cuVVJMICE9IHVuZGVmaW5lZCkgewogICAgICAgIC8vIG1vemlsbGEoZmlyZWZveCkKICAgICAgICB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgfSBlbHNlIGlmICh3aW5kb3cud2Via2l0VVJMICE9IHVuZGVmaW5lZCkgewogICAgICAgIC8vIHdlYmtpdCBvciBjaHJvbWUKICAgICAgICB1cmwgPSB3aW5kb3cud2Via2l0VVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHVybDsKICAgIH07IC8v54K55Ye756Gu5a6a6L+b6KGM6KOB5YmqCgoKICAgIFZ1ZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2UoKTsKICAgICAgdmFyIGNyb3BwZWRDYW52YXM7CiAgICAgIHZhciByb3VuZGVkQ2FudmFzOyAvLyBDcm9wCgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBjcm9wcGVkQ2FudmFzID0gc2VsZi5jcm9wcGVyLmdldENyb3BwZWRDYW52YXMoKTsgLy8gUm91bmQKCiAgICAgICAgcm91bmRlZENhbnZhcyA9IHNlbGYuZ2V0Um91bmRlZENhbnZhcyhjcm9wcGVkQ2FudmFzKTsKICAgICAgICB2YXIgaW1nRGF0YSA9IHJvdW5kZWRDYW52YXMudG9EYXRhVVJMKCk7CiAgICAgICAgaW1hZ2Uuc3JjID0gaW1nRGF0YTsgLy/liKTmlq3lm77niYfmmK/lkKblpKfkuo4xMDBrLOS4jeWkp+S6juebtOaOpeS4iuS8oO+8jOWPjeS5i+WOi+e8qQoKICAgICAgICBpZiAoaW1nRGF0YS5sZW5ndGggPCAxMDAgKiAxMDI0KSB7CiAgICAgICAgICBzZWxmLnJlc3VsdE9iai5zcmMgPSBpbWdEYXRhOyAvL+WbvueJh+S4iuS8oAoKICAgICAgICAgIHNlbGYucG9zdEltZyhpbWdEYXRhKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaW1hZ2Uub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvL+WOi+e8qeWkhOeQhgogICAgICAgICAgICB2YXIgZGF0YSA9IHNlbGYuY29tcHJlc3MoaW1hZ2UsIHNlbGYuT3JpZW50YXRpb24pOwogICAgICAgICAgICBzZWxmLnJlc3VsdE9iai5zcmMgPSBkYXRhOyAvL+WbvueJh+S4iuS8oAoKICAgICAgICAgICAgc2VsZi5wb3N0SW1nKGRhdGEpOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sIDIwKTsKICAgIH07IC8v6I635Y+W6KOB5Ymq5Zu+54mH6LWE5rqQCgoKICAgIFZ1ZS5wcm90b3R5cGUuZ2V0Um91bmRlZENhbnZhcyA9IGZ1bmN0aW9uIChzb3VyY2VDYW52YXMpIHsKICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICB2YXIgd2lkdGggPSBzb3VyY2VDYW52YXMud2lkdGg7CiAgICAgIHZhciBoZWlnaHQgPSBzb3VyY2VDYW52YXMuaGVpZ2h0OwogICAgICBjYW52YXMud2lkdGggPSB3aWR0aDsKICAgICAgY2FudmFzLmhlaWdodCA9IGhlaWdodDsKICAgICAgY29udGV4dC5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSB0cnVlOwogICAgICBjb250ZXh0LmRyYXdJbWFnZShzb3VyY2VDYW52YXMsIDAsIDAsIHdpZHRoLCBoZWlnaHQpOwogICAgICBjb250ZXh0Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdkZXN0aW5hdGlvbi1pbic7CiAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7CiAgICAgIGNvbnRleHQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgICAgY29udGV4dC5maWxsKCk7CiAgICAgIHJldHVybiBjYW52YXM7CiAgICB9OyAvL+mUgOavgeWOn+adpeeahOWvueixoQoKCiAgICBWdWUucHJvdG90eXBlLmRlc3RvcmllZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOyAvL+enu+mZpOS6i+S7tgoKICAgICAgdGhpcy5yZW1vdmVFdmVudCh0aGlzLmNsaWNrQnRuLCAnY2xpY2snLCBudWxsKTsKICAgICAgdGhpcy5yZW1vdmVFdmVudCh0aGlzLmNhbmNlbEJ0biwgJ2NsaWNrJywgbnVsbCk7CiAgICAgIHRoaXMucmVtb3ZlRXZlbnQodGhpcy5maWxlT2JqLCAnY2xpY2snLCBudWxsKTsgLy/np7vpmaToo4HliarmoYYKCiAgICAgIHRoaXMucmVhZ2lvbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMucmVhZ2lvbik7IC8v6ZSA5q+B6KOB5Ymq5a+56LGhCgogICAgICB0aGlzLmNyb3BwZXIuZGVzdHJveSgpOwogICAgICB0aGlzLmNyb3BwZXIgPSBudWxsOwogICAgfTsgLy/lm77niYfkuIrkvKAKCgogICAgVnVlLnByb3RvdHlwZS5wb3N0SW1nID0gZnVuY3Rpb24gKGltYWdlRGF0YSkgewogICAgICAvL+i/mei+ueWGmeWbvueJh+eahOS4iuS8oAogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHNlbGYuZGVzdG9yaWVkKCk7CiAgICAgIGNvbnNvbGUubG9nKCflm77niYfkuIrkvKDnu5PmnZ8nKTsKICAgIH07IC8v5Zu+54mH5peL6L2sCgoKICAgIFZ1ZS5wcm90b3R5cGUucm90YXRlSW1nID0gZnVuY3Rpb24gKGltZywgZGlyZWN0aW9uLCBjYW52YXMpIHsKICAgICAgLy/mnIDlsI/kuI7mnIDlpKfml4vovazmlrnlkJHvvIzlm77niYfml4vovaw05qyh5ZCO5Zue5Yiw5Y6f5pa55ZCRCiAgICAgIHZhciBtaW5fc3RlcCA9IDA7CiAgICAgIHZhciBtYXhfc3RlcCA9IDM7CiAgICAgIGlmIChpbWcgPT0gbnVsbCkgcmV0dXJuOyAvL2ltZ+eahOmrmOW6puWSjOWuveW6puS4jeiDveWcqGltZ+WFg+e0oOmakOiXj+WQjuiOt+WPlu+8jOWQpuWImeS8muWHuumUmQoKICAgICAgdmFyIGhlaWdodCA9IGltZy5oZWlnaHQ7CiAgICAgIHZhciB3aWR0aCA9IGltZy53aWR0aDsKICAgICAgdmFyIHN0ZXAgPSAyOwoKICAgICAgaWYgKHN0ZXAgPT0gbnVsbCkgewogICAgICAgIHN0ZXAgPSBtaW5fc3RlcDsKICAgICAgfQoKICAgICAgaWYgKGRpcmVjdGlvbiA9PSAncmlnaHQnKSB7CiAgICAgICAgc3RlcCsrOyAvL+aXi+i9rOWIsOWOn+S9jee9ru+8jOWNs+i2hei/h+acgOWkp+WAvAoKICAgICAgICBzdGVwID4gbWF4X3N0ZXAgJiYgKHN0ZXAgPSBtaW5fc3RlcCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3RlcC0tOwogICAgICAgIHN0ZXAgPCBtaW5fc3RlcCAmJiAoc3RlcCA9IG1heF9zdGVwKTsKICAgICAgfSAvL+aXi+i9rOinkuW6puS7peW8p+W6puWAvOS4uuWPguaVsAoKCiAgICAgIHZhciBkZWdyZWUgPSBzdGVwICogOTAgKiBNYXRoLlBJIC8gMTgwOwogICAgICB2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CgogICAgICBzd2l0Y2ggKHN0ZXApIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBjYW52YXMud2lkdGggPSB3aWR0aDsKICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgICAgICBjdHguZHJhd0ltYWdlKGltZywgMCwgMCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAxOgogICAgICAgICAgY2FudmFzLndpZHRoID0gaGVpZ2h0OwogICAgICAgICAgY2FudmFzLmhlaWdodCA9IHdpZHRoOwogICAgICAgICAgY3R4LnJvdGF0ZShkZWdyZWUpOwogICAgICAgICAgY3R4LmRyYXdJbWFnZShpbWcsIDAsIC1oZWlnaHQpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjoKICAgICAgICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoOwogICAgICAgICAgY2FudmFzLmhlaWdodCA9IGhlaWdodDsKICAgICAgICAgIGN0eC5yb3RhdGUoZGVncmVlKTsKICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAtd2lkdGgsIC1oZWlnaHQpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMzoKICAgICAgICAgIGNhbnZhcy53aWR0aCA9IGhlaWdodDsKICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSB3aWR0aDsKICAgICAgICAgIGN0eC5yb3RhdGUoZGVncmVlKTsKICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAtd2lkdGgsIDApOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH07IC8v5Zu+54mH5Y6L57ypCgoKICAgIFZ1ZS5wcm90b3R5cGUuY29tcHJlc3MgPSBmdW5jdGlvbiAoaW1nLCBPcmllbnRhdGlvbikgewogICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsgLy/nk6bniYdjYW52YXMKCiAgICAgIHZhciB0Q2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgIHZhciB0Y3R4ID0gdENhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwogICAgICB2YXIgaW5pdFNpemUgPSBpbWcuc3JjLmxlbmd0aDsKICAgICAgdmFyIHdpZHRoID0gaW1nLndpZHRoOwogICAgICB2YXIgaGVpZ2h0ID0gaW1nLmhlaWdodDsgLy/lpoLmnpzlm77niYflpKfkuo7lm5vnmb7kuIflg4/ntKDvvIzorqHnrpfljovnvKnmr5TlubblsIblpKflsI/ljovoh7M0MDDkuIfku6XkuIsKCiAgICAgIHZhciByYXRpbzsKCiAgICAgIGlmICgocmF0aW8gPSB3aWR0aCAqIGhlaWdodCAvIDQwMDAwMDApID4gMSkgewogICAgICAgIGNvbnNvbGUubG9nKCLlpKfkuo40MDDkuIflg4/ntKAiKTsKICAgICAgICByYXRpbyA9IE1hdGguc3FydChyYXRpbyk7CiAgICAgICAgd2lkdGggLz0gcmF0aW87CiAgICAgICAgaGVpZ2h0IC89IHJhdGlvOwogICAgICB9IGVsc2UgewogICAgICAgIHJhdGlvID0gMTsKICAgICAgfQoKICAgICAgY2FudmFzLndpZHRoID0gd2lkdGg7CiAgICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7IC8vICAgICAgICDpk7rlupXoibIKCiAgICAgIGN0eC5maWxsU3R5bGUgPSAiI2ZmZiI7CiAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpOyAvL+WmguaenOWbvueJh+WDj+e0oOWkp+S6jjEwMOS4h+WImeS9v+eUqOeTpueJh+e7mOWItgoKICAgICAgdmFyIGNvdW50OwoKICAgICAgaWYgKChjb3VudCA9IHdpZHRoICogaGVpZ2h0IC8gMTAwMDAwMCkgPiAxKSB7CiAgICAgICAgY291bnQgPSB+fihNYXRoLnNxcnQoY291bnQpICsgMSk7IC8v6K6h566X6KaB5YiG5oiQ5aSa5bCR5Z2X55Om54mHCiAgICAgICAgLy8gICAgICAgICAgICDorqHnrpfmr4/lnZfnk6bniYfnmoTlrr3lkozpq5gKCiAgICAgICAgdmFyIG53ID0gfn4od2lkdGggLyBjb3VudCk7CiAgICAgICAgdmFyIG5oID0gfn4oaGVpZ2h0IC8gY291bnQpOwogICAgICAgIHRDYW52YXMud2lkdGggPSBudzsKICAgICAgICB0Q2FudmFzLmhlaWdodCA9IG5oOwoKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY291bnQ7IGorKykgewogICAgICAgICAgICB0Y3R4LmRyYXdJbWFnZShpbWcsIGkgKiBudyAqIHJhdGlvLCBqICogbmggKiByYXRpbywgbncgKiByYXRpbywgbmggKiByYXRpbywgMCwgMCwgbncsIG5oKTsKICAgICAgICAgICAgY3R4LmRyYXdJbWFnZSh0Q2FudmFzLCBpICogbncsIGogKiBuaCwgbncsIG5oKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY3R4LmRyYXdJbWFnZShpbWcsIDAsIDAsIHdpZHRoLCBoZWlnaHQpOwogICAgICB9IC8v5L+u5aSNaW9z5LiK5Lyg5Zu+54mH55qE5pe25YCZIOiiq+aXi+i9rOeahOmXrumimAoKCiAgICAgIGlmIChPcmllbnRhdGlvbiAhPSAiIiAmJiBPcmllbnRhdGlvbiAhPSAxKSB7CiAgICAgICAgc3dpdGNoIChPcmllbnRhdGlvbikgewogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAvL+mcgOimgemhuuaXtumSiO+8iOWQkeW3pu+8iTkw5bqm5peL6L2sCiAgICAgICAgICAgIHRoaXMucm90YXRlSW1nKGltZywgJ2xlZnQnLCBjYW52YXMpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIC8v6ZyA6KaB6YCG5pe26ZKI77yI5ZCR5Y+z77yJOTDluqbml4vovawKICAgICAgICAgICAgdGhpcy5yb3RhdGVJbWcoaW1nLCAncmlnaHQnLCBjYW52YXMpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIC8v6ZyA6KaBMTgw5bqm5peL6L2sCiAgICAgICAgICAgIHRoaXMucm90YXRlSW1nKGltZywgJ3JpZ2h0JywgY2FudmFzKTsgLy/ovazkuKTmrKEKCiAgICAgICAgICAgIHRoaXMucm90YXRlSW1nKGltZywgJ3JpZ2h0JywgY2FudmFzKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9IC8v6L+b6KGM5pyA5bCP5Y6L57ypCgoKICAgICAgdmFyIG5kYXRhID0gY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvanBlZycsIDAuMSk7CiAgICAgIGNvbnNvbGUubG9nKCfljovnvKnliY3vvJonICsgaW5pdFNpemUpOwogICAgICBjb25zb2xlLmxvZygn5Y6L57yp5ZCO77yaJyArIG5kYXRhLmxlbmd0aCk7CiAgICAgIGNvbnNvbGUubG9nKCfljovnvKnnjofvvJonICsgfn4oMTAwICogKGluaXRTaXplIC0gbmRhdGEubGVuZ3RoKSAvIGluaXRTaXplKSArICIlIik7CiAgICAgIHRDYW52YXMud2lkdGggPSB0Q2FudmFzLmhlaWdodCA9IGNhbnZhcy53aWR0aCA9IGNhbnZhcy5oZWlnaHQgPSAwOwogICAgICByZXR1cm4gbmRhdGE7CiAgICB9OyAvL+a3u+WKoOS6i+S7tgoKCiAgICBWdWUucHJvdG90eXBlLmFkZEV2ZW50ID0gZnVuY3Rpb24gKG9iaiwgdHlwZSwgZm4pIHsKICAgICAgaWYgKG9iai5hZGRFdmVudExpc3RlbmVyKSB7CiAgICAgICAgb2JqLmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgZm4sIGZhbHNlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvYmouYXR0YWNoRXZlbnQoJ29uJyArIHR5cGUsIGZuKTsKICAgICAgfQogICAgfTsgLy/np7vpmaTkuovku7YKCgogICAgVnVlLnByb3RvdHlwZS5yZW1vdmVFdmVudCA9IGZ1bmN0aW9uIChvYmosIHR5cGUsIGZuKSB7CiAgICAgIGlmIChvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcikgewogICAgICAgIG9iai5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGZuLCBmYWxzZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb2JqLmRldGFjaEV2ZW50KCdvbicgKyB0eXBlLCBmbik7CiAgICAgIH0KICAgIH07CiAgfQp9Ow=="},{"version":3,"sources":["/Users/yoon/jz-video/src/service/base/clipper.js"],"names":["Cropper","Exif","install","Vue","prototype","initilize","opt","self","options","createElement","resultObj","cropper","preview","aspectRatio","autoCropArea","viewMode","guides","cropBoxResizable","cropBoxMovable","dragCrop","background","checkOrientation","checkCrossOrigin","zoomable","zoomOnWheel","center","toggleDragModeOnDblclick","ready","cropBox","querySelector","style","outline","disable","str","body","document","getElementsByTagName","reagion","id","className","innerHTML","appendChild","getElementById","initFunction","clickBtn","cancelBtn","addEvent","crop","destoried","fileObj","value","clip","e","srcElement","files","target","dataTransfer","length","picValue","getData","Orientation","getTag","console","log","originUrl","getObjectURL","replace","file","url","window","createObjectURL","undefined","URL","webkitURL","image","Image","croppedCanvas","roundedCanvas","setTimeout","getCroppedCanvas","getRoundedCanvas","imgData","toDataURL","src","postImg","onload","data","compress","sourceCanvas","canvas","context","getContext","width","height","imageSmoothingEnabled","drawImage","globalCompositeOperation","beginPath","rect","fill","removeEvent","parentNode","removeChild","destroy","imageData","rotateImg","img","direction","min_step","max_step","step","degree","Math","PI","ctx","rotate","tCanvas","tctx","initSize","ratio","sqrt","fillStyle","fillRect","count","nw","nh","i","j","ndata","obj","type","fn","addEventListener","attachEvent","removeEventListener","detachEvent"],"mappings":"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","sourcesContent":["/**\r\n *\tname : vue 的图片裁减压缩处理\r\n *   dependence :\r\n *       cropper 第三方的一个裁剪库\r\n *       exif    获取图片源信息，解决ios图片旋转的问题\r\n * */\r\n\r\nimport Cropper from 'cropperjs'\r\nimport Exif from 'exif-js'\r\nexport default {\r\n\tinstall(Vue) {\r\n\t\t//初始化方法\r\n\t\tVue.prototype.initilize = function(opt) {\r\n\t\t\tlet self = this;\r\n\t\t\tthis.options = opt;\r\n\t\t\t//创建dom\r\n\t\t\tthis.createElement();\r\n\t\t\tthis.resultObj = opt.resultObj;\r\n\t\t\t//初始化裁剪对象\r\n\t\t\tthis.cropper = new Cropper(this.preview, {\r\n\t\t\t\taspectRatio: opt.aspectRatio || 1,\r\n\t\t\t\tautoCropArea: opt.autoCropArea || 0.8,\r\n\t\t\t\tviewMode: 1,\r\n\t\t\t\tguides: opt.aspectRatio == 'Free' ? false : true,\r\n\t\t\t\tcropBoxResizable: opt.aspectRatio == 'Free' ? false : true,\r\n\t\t\t\tcropBoxMovable: opt.aspectRatio == 'Free' ? false : true,\r\n\t\t\t\tdragCrop: opt.aspectRatio == 'Free' ? false : true,\r\n\t\t\t\tbackground: false,\r\n\t\t\t\tcheckOrientation: true,\r\n\t\t\t\tcheckCrossOrigin: true,\r\n\t\t\t\tzoomable: false,\r\n\t\t\t\tzoomOnWheel: false,\r\n\t\t\t\tcenter: false,\r\n\t\t\t\ttoggleDragModeOnDblclick: false,\r\n\t\t\t\tready: function() {\r\n\t\t\t\t\t// console.log(self.cropper.rotate(90))\r\n\t\t\t\t\tif (opt.aspectRatio == 'Free') {\r\n\t\t\t\t\t\tlet cropBox = self.cropper.cropBox;\r\n\t\t\t\t\t\tcropBox.querySelector('span.cropper-view-box').style.outline = 'none';\r\n\t\t\t\t\t\tself.cropper.disable();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t//创建一些必要的DOM，用于图片裁剪\r\n\t\tVue.prototype.createElement = function() {\r\n\t\t\t//初始化图片为空对象\r\n\t\t\tthis.preview = null;\r\n\r\n\t\t\tlet str =\r\n\t\t\t\t'<div><img id=\"clip_image\" src=\"originUrl\"></div><button type=\"button\" id=\"cancel_clip\">取消</button><button type=\"button\" id=\"clip_button\">确定</button>';\r\n\r\n\r\n\t\t\tlet body = document.getElementsByTagName('body')[0];\r\n\t\t\tthis.reagion = document.createElement('div');\r\n\t\t\tthis.reagion.id = 'clip_container';\r\n\t\t\tthis.reagion.className = 'container';\r\n\t\t\tthis.reagion.innerHTML = str;\r\n\t\t\t//添加创建好的DOM元素\r\n\t\t\tbody.appendChild(this.reagion);\r\n\t\t\tthis.preview = document.getElementById('clip_image');\r\n\r\n\t\t\t//绑定一些方法\r\n\t\t\tthis.initFunction();\r\n\t\t}\r\n\t\t//初始化一些函数绑定\r\n\t\tVue.prototype.initFunction = function() {\r\n\t\t\tlet self = this;\r\n\t\t\tthis.clickBtn = document.getElementById('clip_button');\r\n\t\t\tthis.cancelBtn = document.getElementById('cancel_clip');\r\n\t\t\t//确定事件\r\n\t\t\tthis.addEvent(this.clickBtn, 'click', function() {\r\n\t\t\t\tself.crop();\r\n\t\t\t})\r\n\t\t\t//取消事件\r\n\t\t\tthis.addEvent(this.cancelBtn, 'click', function() {\r\n\t\t\t\tself.destoried();\r\n\t\t\t})\r\n\t\t\t//清空input的值\r\n\t\t\tthis.addEvent(this.fileObj, 'click', function() {\r\n\t\t\t\tthis.value = '';\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t//外部接口，用于input['file']对象change时的调用\r\n\t\tVue.prototype.clip = function(e, opt) {\r\n\t\t\tlet self = this;\r\n\r\n\t\t\tthis.fileObj = e.srcElement;\r\n\r\n\t\t\tlet files = e.target.files || e.dataTransfer.files;\r\n\r\n\t\t\tif (!files.length) return false; //不是图片直接返回\r\n\r\n\t\t\t//调用初始化方法\r\n\t\t\tthis.initilize(opt);\r\n\r\n\t\t\t//获取图片文件资源\r\n\t\t\tthis.picValue = files[0];\r\n\r\n\t\t\t//去获取拍照时的信息，解决拍出来的照片旋转问题\r\n\t\t\tExif.getData(files[0], function() {\r\n\t\t\t\tself.Orientation = Exif.getTag(files[0], 'Orientation');\r\n\t\t\t\tconsole.log(self.Orientation)\r\n\t\t\t});\r\n\r\n\r\n\t\t\t//调用方法转成url格式\r\n\t\t\tthis.originUrl = this.getObjectURL(this.picValue);\r\n\r\n\t\t\t//每次替换图片要重新得到新的url\r\n\t\t\tif (this.cropper) {\r\n\t\t\t\tthis.cropper.replace(this.originUrl);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t//图片转码方法\r\n\t\tVue.prototype.getObjectURL = function(file) {\r\n\t\t\tlet url = null;\r\n\t\t\tif (window.createObjectURL != undefined) { // basic\r\n\t\t\t\turl = window.createObjectURL(file);\r\n\t\t\t} else if (window.URL != undefined) { // mozilla(firefox)\r\n\t\t\t\turl = window.URL.createObjectURL(file);\r\n\t\t\t} else if (window.webkitURL != undefined) { // webkit or chrome\r\n\t\t\t\turl = window.webkitURL.createObjectURL(file);\r\n\t\t\t}\r\n\t\t\treturn url;\r\n\t\t}\r\n\t\t//点击确定进行裁剪\r\n\t\tVue.prototype.crop = function() {\r\n\t\t\tlet self = this;\r\n\t\t\tlet image = new Image();\r\n\t\t\tlet croppedCanvas;\r\n\t\t\tlet roundedCanvas;\r\n\r\n\t\t\t// Crop\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tcroppedCanvas = self.cropper.getCroppedCanvas();\r\n\t\t\t\t// Round\r\n\t\t\t\troundedCanvas = self.getRoundedCanvas(croppedCanvas);\r\n\r\n\t\t\t\tlet imgData = roundedCanvas.toDataURL();\r\n\t\t\t\timage.src = imgData;\r\n\r\n\t\t\t\t//判断图片是否大于100k,不大于直接上传，反之压缩\r\n\t\t\t\tif (imgData.length < (100 * 1024)) {\r\n\t\t\t\t\tself.resultObj.src = imgData;\r\n\t\t\t\t\t//图片上传\r\n\t\t\t\t\tself.postImg(imgData);\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\timage.onload = function() {\r\n\t\t\t\t\t\t//压缩处理\r\n\t\t\t\t\t\tlet data = self.compress(image, self.Orientation);\r\n\t\t\t\t\t\tself.resultObj.src = data;\r\n\t\t\t\t\t\t//图片上传\r\n\t\t\t\t\t\tself.postImg(data);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, 20)\r\n\t\t}\r\n\t\t//获取裁剪图片资源\r\n\t\tVue.prototype.getRoundedCanvas = function(sourceCanvas) {\r\n\r\n\t\t\tlet canvas = document.createElement('canvas');\r\n\t\t\tlet context = canvas.getContext('2d');\r\n\t\t\tlet width = sourceCanvas.width;\r\n\t\t\tlet height = sourceCanvas.height;\r\n\r\n\t\t\tcanvas.width = width;\r\n\t\t\tcanvas.height = height;\r\n\r\n\t\t\tcontext.imageSmoothingEnabled = true;\r\n\t\t\tcontext.drawImage(sourceCanvas, 0, 0, width, height);\r\n\t\t\tcontext.globalCompositeOperation = 'destination-in';\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.rect(0, 0, width, height);\r\n\t\t\tcontext.fill();\r\n\r\n\t\t\treturn canvas;\r\n\t\t}\r\n\t\t//销毁原来的对象\r\n\t\tVue.prototype.destoried = function() {\r\n\t\t\tlet self = this;\r\n\t\t\t//移除事件\r\n\t\t\tthis.removeEvent(this.clickBtn, 'click', null);\r\n\t\t\tthis.removeEvent(this.cancelBtn, 'click', null);\r\n\t\t\tthis.removeEvent(this.fileObj, 'click', null);\r\n\t\t\t//移除裁剪框\r\n\t\t\tthis.reagion.parentNode.removeChild(this.reagion);\r\n\r\n\t\t\t//销毁裁剪对象\r\n\t\t\tthis.cropper.destroy();\r\n\t\t\tthis.cropper = null;\r\n\t\t}\r\n\t\t//图片上传\r\n\t\tVue.prototype.postImg = function(imageData) {\r\n\r\n\r\n\t\t\t//这边写图片的上传\r\n\r\n\r\n\r\n\t\t\tlet self = this;\r\n\t\t\tself.destoried();\r\n\t\t\tconsole.log('图片上传结束');\r\n\t\t}\r\n\r\n\t\t//图片旋转\r\n\t\tVue.prototype.rotateImg = function(img, direction, canvas) {\r\n\t\t\t//最小与最大旋转方向，图片旋转4次后回到原方向\r\n\t\t\tconst min_step = 0;\r\n\t\t\tconst max_step = 3;\r\n\t\t\tif (img == null) return;\r\n\t\t\t//img的高度和宽度不能在img元素隐藏后获取，否则会出错\r\n\t\t\tlet height = img.height;\r\n\t\t\tlet width = img.width;\r\n\t\t\tlet step = 2;\r\n\t\t\tif (step == null) {\r\n\t\t\t\tstep = min_step;\r\n\t\t\t}\r\n\t\t\tif (direction == 'right') {\r\n\t\t\t\tstep++;\r\n\t\t\t\t//旋转到原位置，即超过最大值\r\n\t\t\t\tstep > max_step && (step = min_step);\r\n\t\t\t} else {\r\n\t\t\t\tstep--;\r\n\t\t\t\tstep < min_step && (step = max_step);\r\n\t\t\t}\r\n\t\t\t//旋转角度以弧度值为参数\r\n\t\t\tlet degree = step * 90 * Math.PI / 180;\r\n\t\t\tlet ctx = canvas.getContext('2d');\r\n\t\t\tswitch (step) {\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tcanvas.width = width;\r\n\t\t\t\t\tcanvas.height = height;\r\n\t\t\t\t\tctx.drawImage(img, 0, 0);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tcanvas.width = height;\r\n\t\t\t\t\tcanvas.height = width;\r\n\t\t\t\t\tctx.rotate(degree);\r\n\t\t\t\t\tctx.drawImage(img, 0, -height);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tcanvas.width = width;\r\n\t\t\t\t\tcanvas.height = height;\r\n\t\t\t\t\tctx.rotate(degree);\r\n\t\t\t\t\tctx.drawImage(img, -width, -height);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tcanvas.width = height;\r\n\t\t\t\t\tcanvas.height = width;\r\n\t\t\t\t\tctx.rotate(degree);\r\n\t\t\t\t\tctx.drawImage(img, -width, 0);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//图片压缩\r\n\t\tVue.prototype.compress = function(img, Orientation) {\r\n\t\t\tlet canvas = document.createElement(\"canvas\");\r\n\t\t\tlet ctx = canvas.getContext('2d');\r\n\t\t\t//瓦片canvas\r\n\t\t\tlet tCanvas = document.createElement(\"canvas\");\r\n\t\t\tlet tctx = tCanvas.getContext(\"2d\");\r\n\t\t\tlet initSize = img.src.length;\r\n\t\t\tlet width = img.width;\r\n\t\t\tlet height = img.height;\r\n\r\n\t\t\t//如果图片大于四百万像素，计算压缩比并将大小压至400万以下\r\n\t\t\tlet ratio;\r\n\t\t\tif ((ratio = width * height / 4000000) > 1) {\r\n\t\t\t\tconsole.log(\"大于400万像素\")\r\n\t\t\t\tratio = Math.sqrt(ratio);\r\n\t\t\t\twidth /= ratio;\r\n\t\t\t\theight /= ratio;\r\n\t\t\t} else {\r\n\t\t\t\tratio = 1;\r\n\t\t\t}\r\n\t\t\tcanvas.width = width;\r\n\t\t\tcanvas.height = height;\r\n\t\t\t//        铺底色\r\n\t\t\tctx.fillStyle = \"#fff\";\r\n\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t\t//如果图片像素大于100万则使用瓦片绘制\r\n\t\t\tlet count;\r\n\t\t\tif ((count = width * height / 1000000) > 1) {\r\n\t\t\t\tcount = ~~(Math.sqrt(count) + 1); //计算要分成多少块瓦片\r\n\t\t\t\t//            计算每块瓦片的宽和高\r\n\t\t\t\tlet nw = ~~(width / count);\r\n\t\t\t\tlet nh = ~~(height / count);\r\n\t\t\t\ttCanvas.width = nw;\r\n\t\t\t\ttCanvas.height = nh;\r\n\t\t\t\tfor (let i = 0; i < count; i++) {\r\n\t\t\t\t\tfor (let j = 0; j < count; j++) {\r\n\t\t\t\t\t\ttctx.drawImage(img, i * nw * ratio, j * nh * ratio, nw * ratio, nh * ratio, 0, 0, nw, nh);\r\n\t\t\t\t\t\tctx.drawImage(tCanvas, i * nw, j * nh, nw, nh);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tctx.drawImage(img, 0, 0, width, height);\r\n\t\t\t}\r\n\t\t\t//修复ios上传图片的时候 被旋转的问题\r\n\t\t\tif (Orientation != \"\" && Orientation != 1) {\r\n\t\t\t\tswitch (Orientation) {\r\n\t\t\t\t\tcase 6: //需要顺时针（向左）90度旋转\r\n\t\t\t\t\t\tthis.rotateImg(img, 'left', canvas);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 8: //需要逆时针（向右）90度旋转\r\n\t\t\t\t\t\tthis.rotateImg(img, 'right', canvas);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 3: //需要180度旋转\r\n\t\t\t\t\t\tthis.rotateImg(img, 'right', canvas); //转两次\r\n\t\t\t\t\t\tthis.rotateImg(img, 'right', canvas);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//进行最小压缩\r\n\t\t\tlet ndata = canvas.toDataURL('image/jpeg', 0.1);\r\n\t\t\tconsole.log('压缩前：' + initSize);\r\n\t\t\tconsole.log('压缩后：' + ndata.length);\r\n\t\t\tconsole.log('压缩率：' + ~~(100 * (initSize - ndata.length) / initSize) + \"%\");\r\n\t\t\ttCanvas.width = tCanvas.height = canvas.width = canvas.height = 0;\r\n\r\n\t\t\treturn ndata;\r\n\t\t}\r\n\r\n\t\t//添加事件\r\n\t\tVue.prototype.addEvent = function(obj, type, fn) {\r\n\t\t\tif (obj.addEventListener) {\r\n\t\t\t\tobj.addEventListener(type, fn, false);\r\n\t\t\t} else {\r\n\t\t\t\tobj.attachEvent('on' + type, fn);\r\n\t\t\t}\r\n\t\t}\r\n\t\t//移除事件\r\n\t\tVue.prototype.removeEvent = function(obj, type, fn) {\r\n\t\t\tif (obj.removeEventListener) {\r\n\t\t\t\tobj.removeEventListener(type, fn, false);\r\n\t\t\t} else {\r\n\t\t\t\tobj.detachEvent('on' + type, fn);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\n"]}]}