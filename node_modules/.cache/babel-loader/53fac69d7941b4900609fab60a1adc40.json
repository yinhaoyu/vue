{"remainingRequest":"/Users/yoon/jz-video/node_modules/thread-loader/dist/cjs.js!/Users/yoon/jz-video/node_modules/babel-loader/lib/index.js!/Users/yoon/jz-video/node_modules/eslint-loader/index.js??ref--13-0!/Users/yoon/jz-video/src/service/base/clipper.js","dependencies":[{"path":"/Users/yoon/jz-video/src/service/base/clipper.js","mtime":1582766155311},{"path":"/Users/yoon/jz-video/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yoon/jz-video/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yoon/jz-video/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yoon/jz-video/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsbCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwiOwoKLyoqDQogKgluYW1lIDogdnVlIOeahOWbvueJh+ijgeWHj+WOi+e8qeWkhOeQhg0KICogICBkZXBlbmRlbmNlIDoNCiAqICAgICAgIGNyb3BwZXIg56ys5LiJ5pa555qE5LiA5Liq6KOB5Ymq5bqTDQogKiAgICAgICBleGlmICAgIOiOt+WPluWbvueJh+a6kOS/oeaBr++8jOino+WGs2lvc+WbvueJh+aXi+i9rOeahOmXrumimA0KICogKi8KaW1wb3J0IENyb3BwZXIgZnJvbSAnY3JvcHBlcmpzJzsKaW1wb3J0IEV4aWYgZnJvbSAnZXhpZi1qcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBpbnN0YWxsOiBmdW5jdGlvbiBpbnN0YWxsKFZ1ZSkgewogICAgLy/liJ3lp4vljJbmlrnms5UKICAgIFZ1ZS5wcm90b3R5cGUuaW5pdGlsaXplID0gZnVuY3Rpb24gKG9wdCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHRoaXMub3B0aW9ucyA9IG9wdDsgLy/liJvlu7pkb20KCiAgICAgIHRoaXMuY3JlYXRlRWxlbWVudCgpOwogICAgICB0aGlzLnJlc3VsdE9iaiA9IG9wdC5yZXN1bHRPYmo7IC8v5Yid5aeL5YyW6KOB5Ymq5a+56LGhCgogICAgICB0aGlzLmNyb3BwZXIgPSBuZXcgQ3JvcHBlcih0aGlzLnByZXZpZXcsIHsKICAgICAgICBhc3BlY3RSYXRpbzogb3B0LmFzcGVjdFJhdGlvIHx8IDEsCiAgICAgICAgYXV0b0Nyb3BBcmVhOiBvcHQuYXV0b0Nyb3BBcmVhIHx8IDAuOCwKICAgICAgICB2aWV3TW9kZTogMSwKICAgICAgICBndWlkZXM6IG9wdC5hc3BlY3RSYXRpbyA9PSAnRnJlZScgPyBmYWxzZSA6IHRydWUsCiAgICAgICAgY3JvcEJveFJlc2l6YWJsZTogb3B0LmFzcGVjdFJhdGlvID09ICdGcmVlJyA/IGZhbHNlIDogdHJ1ZSwKICAgICAgICBjcm9wQm94TW92YWJsZTogb3B0LmFzcGVjdFJhdGlvID09ICdGcmVlJyA/IGZhbHNlIDogdHJ1ZSwKICAgICAgICBkcmFnQ3JvcDogb3B0LmFzcGVjdFJhdGlvID09ICdGcmVlJyA/IGZhbHNlIDogdHJ1ZSwKICAgICAgICBiYWNrZ3JvdW5kOiBmYWxzZSwKICAgICAgICBjaGVja09yaWVudGF0aW9uOiB0cnVlLAogICAgICAgIGNoZWNrQ3Jvc3NPcmlnaW46IHRydWUsCiAgICAgICAgem9vbWFibGU6IGZhbHNlLAogICAgICAgIHpvb21PbldoZWVsOiBmYWxzZSwKICAgICAgICBjZW50ZXI6IGZhbHNlLAogICAgICAgIHRvZ2dsZURyYWdNb2RlT25EYmxjbGljazogZmFsc2UsCiAgICAgICAgcmVhZHk6IGZ1bmN0aW9uIHJlYWR5KCkgewogICAgICAgICAgLy8gY29uc29sZS5sb2coc2VsZi5jcm9wcGVyLnJvdGF0ZSg5MCkpCiAgICAgICAgICBpZiAob3B0LmFzcGVjdFJhdGlvID09ICdGcmVlJykgewogICAgICAgICAgICB2YXIgY3JvcEJveCA9IHNlbGYuY3JvcHBlci5jcm9wQm94OwogICAgICAgICAgICBjcm9wQm94LnF1ZXJ5U2VsZWN0b3IoJ3NwYW4uY3JvcHBlci12aWV3LWJveCcpLnN0eWxlLm91dGxpbmUgPSAnbm9uZSc7CiAgICAgICAgICAgIHNlbGYuY3JvcHBlci5kaXNhYmxlKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH07IC8v5Yib5bu65LiA5Lqb5b+F6KaB55qERE9N77yM55So5LqO5Zu+54mH6KOB5YmqCgoKICAgIFZ1ZS5wcm90b3R5cGUuY3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgLy/liJ3lp4vljJblm77niYfkuLrnqbrlr7nosaEKICAgICAgdGhpcy5wcmV2aWV3ID0gbnVsbDsKICAgICAgdmFyIHN0ciA9ICc8ZGl2PjxpbWcgaWQ9ImNsaXBfaW1hZ2UiIHNyYz0ib3JpZ2luVXJsIj48L2Rpdj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImNhbmNlbF9jbGlwIj7lj5bmtog8L2J1dHRvbj48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImNsaXBfYnV0dG9uIj7noa7lrpo8L2J1dHRvbj4nOwogICAgICB2YXIgYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07CiAgICAgIHRoaXMucmVhZ2lvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICB0aGlzLnJlYWdpb24uaWQgPSAnY2xpcF9jb250YWluZXInOwogICAgICB0aGlzLnJlYWdpb24uY2xhc3NOYW1lID0gJ2NvbnRhaW5lcic7CiAgICAgIHRoaXMucmVhZ2lvbi5pbm5lckhUTUwgPSBzdHI7IC8v5re75Yqg5Yib5bu65aW955qERE9N5YWD57SgCgogICAgICBib2R5LmFwcGVuZENoaWxkKHRoaXMucmVhZ2lvbik7CiAgICAgIHRoaXMucHJldmlldyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGlwX2ltYWdlJyk7IC8v57uR5a6a5LiA5Lqb5pa55rOVCgogICAgICB0aGlzLmluaXRGdW5jdGlvbigpOwogICAgfTsgLy/liJ3lp4vljJbkuIDkupvlh73mlbDnu5HlrpoKCgogICAgVnVlLnByb3RvdHlwZS5pbml0RnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdGhpcy5jbGlja0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGlwX2J1dHRvbicpOwogICAgICB0aGlzLmNhbmNlbEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5jZWxfY2xpcCcpOyAvL+ehruWumuS6i+S7tgoKICAgICAgdGhpcy5hZGRFdmVudCh0aGlzLmNsaWNrQnRuLCAnY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgc2VsZi5jcm9wKCk7CiAgICAgIH0pOyAvL+WPlua2iOS6i+S7tgoKICAgICAgdGhpcy5hZGRFdmVudCh0aGlzLmNhbmNlbEJ0biwgJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgIHNlbGYuZGVzdG9yaWVkKCk7CiAgICAgIH0pOyAvL+a4heepumlucHV055qE5YC8CgogICAgICB0aGlzLmFkZEV2ZW50KHRoaXMuZmlsZU9iaiwgJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMudmFsdWUgPSAnJzsKICAgICAgfSk7CiAgICB9OyAvL+WklumDqOaOpeWPo++8jOeUqOS6jmlucHV0WydmaWxlJ13lr7nosaFjaGFuZ2Xml7bnmoTosIPnlKgKCgogICAgVnVlLnByb3RvdHlwZS5jbGlwID0gZnVuY3Rpb24gKGUsIG9wdCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHRoaXMuZmlsZU9iaiA9IGUuc3JjRWxlbWVudDsKICAgICAgdmFyIGZpbGVzID0gZS50YXJnZXQuZmlsZXMgfHwgZS5kYXRhVHJhbnNmZXIuZmlsZXM7CiAgICAgIGlmICghZmlsZXMubGVuZ3RoKSByZXR1cm4gZmFsc2U7IC8v5LiN5piv5Zu+54mH55u05o6l6L+U5ZueCiAgICAgIC8v6LCD55So5Yid5aeL5YyW5pa55rOVCgogICAgICB0aGlzLmluaXRpbGl6ZShvcHQpOyAvL+iOt+WPluWbvueJh+aWh+S7tui1hOa6kAoKICAgICAgdGhpcy5waWNWYWx1ZSA9IGZpbGVzWzBdOyAvL+WOu+iOt+WPluaLjeeFp+aXtueahOS/oeaBr++8jOino+WGs+aLjeWHuuadpeeahOeFp+eJh+aXi+i9rOmXrumimAogICAgICAvLyBFeGlmLmdldERhdGEoZmlsZXNbMF0sIGZ1bmN0aW9uKCkgewogICAgICAvLyAJc2VsZi5PcmllbnRhdGlvbiA9IEV4aWYuZ2V0VGFnKGZpbGVzWzBdLCAnT3JpZW50YXRpb24nKTsKICAgICAgLy8gCWNvbnNvbGUubG9nKHNlbGYuT3JpZW50YXRpb24pCiAgICAgIC8vIH0pOwogICAgICAvL+iwg+eUqOaWueazlei9rOaIkHVybOagvOW8jwoKICAgICAgdGhpcy5vcmlnaW5VcmwgPSB0aGlzLmdldE9iamVjdFVSTCh0aGlzLnBpY1ZhbHVlKTsgLy/mr4/mrKHmm7/mjaLlm77niYfopoHph43mlrDlvpfliLDmlrDnmoR1cmwKCiAgICAgIGlmICh0aGlzLmNyb3BwZXIpIHsKICAgICAgICB0aGlzLmNyb3BwZXIucmVwbGFjZSh0aGlzLm9yaWdpblVybCk7CiAgICAgIH0KICAgIH07IC8v5Zu+54mH6L2s56CB5pa55rOVCgoKICAgIFZ1ZS5wcm90b3R5cGUuZ2V0T2JqZWN0VVJMID0gZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgdmFyIHVybCA9IG51bGw7CgogICAgICBpZiAod2luZG93LmNyZWF0ZU9iamVjdFVSTCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAvLyBiYXNpYwogICAgICAgIHVybCA9IHdpbmRvdy5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgIH0gZWxzZSBpZiAod2luZG93LlVSTCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAvLyBtb3ppbGxhKGZpcmVmb3gpCiAgICAgICAgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgIH0gZWxzZSBpZiAod2luZG93LndlYmtpdFVSTCAhPSB1bmRlZmluZWQpIHsKICAgICAgICAvLyB3ZWJraXQgb3IgY2hyb21lCiAgICAgICAgdXJsID0gd2luZG93LndlYmtpdFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB1cmw7CiAgICB9OyAvL+eCueWHu+ehruWumui/m+ihjOijgeWJqgoKCiAgICBWdWUucHJvdG90eXBlLmNyb3AgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdmFyIGltYWdlID0gbmV3IEltYWdlKCk7CiAgICAgIHZhciBjcm9wcGVkQ2FudmFzOwogICAgICB2YXIgcm91bmRlZENhbnZhczsgLy8gQ3JvcAoKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgY3JvcHBlZENhbnZhcyA9IHNlbGYuY3JvcHBlci5nZXRDcm9wcGVkQ2FudmFzKCk7IC8vIFJvdW5kCgogICAgICAgIHJvdW5kZWRDYW52YXMgPSBzZWxmLmdldFJvdW5kZWRDYW52YXMoY3JvcHBlZENhbnZhcyk7CiAgICAgICAgdmFyIGltZ0RhdGEgPSByb3VuZGVkQ2FudmFzLnRvRGF0YVVSTCgpOwogICAgICAgIGltYWdlLnNyYyA9IGltZ0RhdGE7IC8v5Yik5pat5Zu+54mH5piv5ZCm5aSn5LqOMTAwayzkuI3lpKfkuo7nm7TmjqXkuIrkvKDvvIzlj43kuYvljovnvKkKCiAgICAgICAgaWYgKGltZ0RhdGEubGVuZ3RoIDwgMTAwICogMTAyNCkgewogICAgICAgICAgc2VsZi5yZXN1bHRPYmouc3JjID0gaW1nRGF0YTsgLy/lm77niYfkuIrkvKAKCiAgICAgICAgICBzZWxmLnBvc3RJbWcoaW1nRGF0YSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGltYWdlLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy/ljovnvKnlpITnkIYKICAgICAgICAgICAgdmFyIGRhdGEgPSBzZWxmLmNvbXByZXNzKGltYWdlLCBzZWxmLk9yaWVudGF0aW9uKTsKICAgICAgICAgICAgc2VsZi5yZXN1bHRPYmouc3JjID0gZGF0YTsgLy/lm77niYfkuIrkvKAKCiAgICAgICAgICAgIHNlbGYucG9zdEltZyhkYXRhKTsKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LCAyMCk7CiAgICB9OyAvL+iOt+WPluijgeWJquWbvueJh+i1hOa6kAoKCiAgICBWdWUucHJvdG90eXBlLmdldFJvdW5kZWRDYW52YXMgPSBmdW5jdGlvbiAoc291cmNlQ2FudmFzKSB7CiAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsKICAgICAgdmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsKICAgICAgdmFyIHdpZHRoID0gc291cmNlQ2FudmFzLndpZHRoOwogICAgICB2YXIgaGVpZ2h0ID0gc291cmNlQ2FudmFzLmhlaWdodDsKICAgICAgY2FudmFzLndpZHRoID0gd2lkdGg7CiAgICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIGNvbnRleHQuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gdHJ1ZTsKICAgICAgY29udGV4dC5kcmF3SW1hZ2Uoc291cmNlQ2FudmFzLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgICAgY29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnZGVzdGluYXRpb24taW4nOwogICAgICBjb250ZXh0LmJlZ2luUGF0aCgpOwogICAgICBjb250ZXh0LnJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7CiAgICAgIGNvbnRleHQuZmlsbCgpOwogICAgICByZXR1cm4gY2FudmFzOwogICAgfTsgLy/plIDmr4Hljp/mnaXnmoTlr7nosaEKCgogICAgVnVlLnByb3RvdHlwZS5kZXN0b3JpZWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsgLy/np7vpmaTkuovku7YKCiAgICAgIHRoaXMucmVtb3ZlRXZlbnQodGhpcy5jbGlja0J0biwgJ2NsaWNrJywgbnVsbCk7CiAgICAgIHRoaXMucmVtb3ZlRXZlbnQodGhpcy5jYW5jZWxCdG4sICdjbGljaycsIG51bGwpOwogICAgICB0aGlzLnJlbW92ZUV2ZW50KHRoaXMuZmlsZU9iaiwgJ2NsaWNrJywgbnVsbCk7IC8v56e76Zmk6KOB5Ymq5qGGCgogICAgICB0aGlzLnJlYWdpb24ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnJlYWdpb24pOyAvL+mUgOavgeijgeWJquWvueixoQoKICAgICAgdGhpcy5jcm9wcGVyLmRlc3Ryb3koKTsKICAgICAgdGhpcy5jcm9wcGVyID0gbnVsbDsKICAgIH07IC8v5Zu+54mH5LiK5LygCgoKICAgIFZ1ZS5wcm90b3R5cGUucG9zdEltZyA9IGZ1bmN0aW9uIChpbWFnZURhdGEpIHsKICAgICAgLy/ov5novrnlhpnlm77niYfnmoTkuIrkvKAKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBzZWxmLmRlc3RvcmllZCgpOwogICAgICBjb25zb2xlLmxvZygn5Zu+54mH5LiK5Lyg57uT5p2fJyk7CiAgICB9OyAvL+WbvueJh+aXi+i9rAoKCiAgICBWdWUucHJvdG90eXBlLnJvdGF0ZUltZyA9IGZ1bmN0aW9uIChpbWcsIGRpcmVjdGlvbiwgY2FudmFzKSB7CiAgICAgIC8v5pyA5bCP5LiO5pyA5aSn5peL6L2s5pa55ZCR77yM5Zu+54mH5peL6L2sNOasoeWQjuWbnuWIsOWOn+aWueWQkQogICAgICB2YXIgbWluX3N0ZXAgPSAwOwogICAgICB2YXIgbWF4X3N0ZXAgPSAzOwogICAgICBpZiAoaW1nID09IG51bGwpIHJldHVybjsgLy9pbWfnmoTpq5jluqblkozlrr3luqbkuI3og73lnKhpbWflhYPntKDpmpDol4/lkI7ojrflj5bvvIzlkKbliJnkvJrlh7rplJkKCiAgICAgIHZhciBoZWlnaHQgPSBpbWcuaGVpZ2h0OwogICAgICB2YXIgd2lkdGggPSBpbWcud2lkdGg7CiAgICAgIHZhciBzdGVwID0gMjsKCiAgICAgIGlmIChzdGVwID09IG51bGwpIHsKICAgICAgICBzdGVwID0gbWluX3N0ZXA7CiAgICAgIH0KCiAgICAgIGlmIChkaXJlY3Rpb24gPT0gJ3JpZ2h0JykgewogICAgICAgIHN0ZXArKzsgLy/ml4vovazliLDljp/kvY3nva7vvIzljbPotoXov4fmnIDlpKflgLwKCiAgICAgICAgc3RlcCA+IG1heF9zdGVwICYmIChzdGVwID0gbWluX3N0ZXApOwogICAgICB9IGVsc2UgewogICAgICAgIHN0ZXAtLTsKICAgICAgICBzdGVwIDwgbWluX3N0ZXAgJiYgKHN0ZXAgPSBtYXhfc3RlcCk7CiAgICAgIH0gLy/ml4vovazop5Lluqbku6XlvKfluqblgLzkuLrlj4LmlbAKCgogICAgICB2YXIgZGVncmVlID0gc3RlcCAqIDkwICogTWF0aC5QSSAvIDE4MDsKICAgICAgdmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwoKICAgICAgc3dpdGNoIChzdGVwKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgY2FudmFzLndpZHRoID0gd2lkdGg7CiAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0OwogICAgICAgICAgY3R4LmRyYXdJbWFnZShpbWcsIDAsIDApOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMToKICAgICAgICAgIGNhbnZhcy53aWR0aCA9IGhlaWdodDsKICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSB3aWR0aDsKICAgICAgICAgIGN0eC5yb3RhdGUoZGVncmVlKTsKICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAwLCAtaGVpZ2h0KTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBjYW52YXMud2lkdGggPSB3aWR0aDsKICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgICAgICBjdHgucm90YXRlKGRlZ3JlZSk7CiAgICAgICAgICBjdHguZHJhd0ltYWdlKGltZywgLXdpZHRoLCAtaGVpZ2h0KTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBjYW52YXMud2lkdGggPSBoZWlnaHQ7CiAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gd2lkdGg7CiAgICAgICAgICBjdHgucm90YXRlKGRlZ3JlZSk7CiAgICAgICAgICBjdHguZHJhd0ltYWdlKGltZywgLXdpZHRoLCAwKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9OyAvL+WbvueJh+WOi+e8qQoKCiAgICBWdWUucHJvdG90eXBlLmNvbXByZXNzID0gZnVuY3Rpb24gKGltZywgT3JpZW50YXRpb24pIHsKICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpOwogICAgICB2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7IC8v55Om54mHY2FudmFzCgogICAgICB2YXIgdENhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpOwogICAgICB2YXIgdGN0eCA9IHRDYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgdmFyIGluaXRTaXplID0gaW1nLnNyYy5sZW5ndGg7CiAgICAgIHZhciB3aWR0aCA9IGltZy53aWR0aDsKICAgICAgdmFyIGhlaWdodCA9IGltZy5oZWlnaHQ7IC8v5aaC5p6c5Zu+54mH5aSn5LqO5Zub55m+5LiH5YOP57Sg77yM6K6h566X5Y6L57yp5q+U5bm25bCG5aSn5bCP5Y6L6IezNDAw5LiH5Lul5LiLCgogICAgICB2YXIgcmF0aW87CgogICAgICBpZiAoKHJhdGlvID0gd2lkdGggKiBoZWlnaHQgLyA0MDAwMDAwKSA+IDEpIHsKICAgICAgICBjb25zb2xlLmxvZygi5aSn5LqONDAw5LiH5YOP57SgIik7CiAgICAgICAgcmF0aW8gPSBNYXRoLnNxcnQocmF0aW8pOwogICAgICAgIHdpZHRoIC89IHJhdGlvOwogICAgICAgIGhlaWdodCAvPSByYXRpbzsKICAgICAgfSBlbHNlIHsKICAgICAgICByYXRpbyA9IDE7CiAgICAgIH0KCiAgICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoOwogICAgICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0OyAvLyAgICAgICAg6ZO65bqV6ImyCgogICAgICBjdHguZmlsbFN0eWxlID0gIiNmZmYiOwogICAgICBjdHguZmlsbFJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsgLy/lpoLmnpzlm77niYflg4/ntKDlpKfkuo4xMDDkuIfliJnkvb/nlKjnk6bniYfnu5jliLYKCiAgICAgIHZhciBjb3VudDsKCiAgICAgIGlmICgoY291bnQgPSB3aWR0aCAqIGhlaWdodCAvIDEwMDAwMDApID4gMSkgewogICAgICAgIGNvdW50ID0gfn4oTWF0aC5zcXJ0KGNvdW50KSArIDEpOyAvL+iuoeeul+imgeWIhuaIkOWkmuWwkeWdl+eTpueJhwogICAgICAgIC8vICAgICAgICAgICAg6K6h566X5q+P5Z2X55Om54mH55qE5a695ZKM6auYCgogICAgICAgIHZhciBudyA9IH5+KHdpZHRoIC8gY291bnQpOwogICAgICAgIHZhciBuaCA9IH5+KGhlaWdodCAvIGNvdW50KTsKICAgICAgICB0Q2FudmFzLndpZHRoID0gbnc7CiAgICAgICAgdENhbnZhcy5oZWlnaHQgPSBuaDsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7CiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNvdW50OyBqKyspIHsKICAgICAgICAgICAgdGN0eC5kcmF3SW1hZ2UoaW1nLCBpICogbncgKiByYXRpbywgaiAqIG5oICogcmF0aW8sIG53ICogcmF0aW8sIG5oICogcmF0aW8sIDAsIDAsIG53LCBuaCk7CiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UodENhbnZhcywgaSAqIG53LCBqICogbmgsIG53LCBuaCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgICAgfSAvL+S/ruWkjWlvc+S4iuS8oOWbvueJh+eahOaXtuWAmSDooqvml4vovaznmoTpl67popgKCgogICAgICBpZiAoT3JpZW50YXRpb24gIT0gIiIgJiYgT3JpZW50YXRpb24gIT0gMSkgewogICAgICAgIHN3aXRjaCAoT3JpZW50YXRpb24pIHsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgLy/pnIDopoHpobrml7bpkojvvIjlkJHlt6bvvIk5MOW6puaXi+i9rAogICAgICAgICAgICB0aGlzLnJvdGF0ZUltZyhpbWcsICdsZWZ0JywgY2FudmFzKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAvL+mcgOimgemAhuaXtumSiO+8iOWQkeWPs++8iTkw5bqm5peL6L2sCiAgICAgICAgICAgIHRoaXMucm90YXRlSW1nKGltZywgJ3JpZ2h0JywgY2FudmFzKTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAvL+mcgOimgTE4MOW6puaXi+i9rAogICAgICAgICAgICB0aGlzLnJvdGF0ZUltZyhpbWcsICdyaWdodCcsIGNhbnZhcyk7IC8v6L2s5Lik5qyhCgogICAgICAgICAgICB0aGlzLnJvdGF0ZUltZyhpbWcsICdyaWdodCcsIGNhbnZhcyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfSAvL+i/m+ihjOacgOWwj+WOi+e8qQoKCiAgICAgIHZhciBuZGF0YSA9IGNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL2pwZWcnLCAwLjEpOwogICAgICBjb25zb2xlLmxvZygn5Y6L57yp5YmN77yaJyArIGluaXRTaXplKTsKICAgICAgY29uc29sZS5sb2coJ+WOi+e8qeWQju+8micgKyBuZGF0YS5sZW5ndGgpOwogICAgICBjb25zb2xlLmxvZygn5Y6L57yp546H77yaJyArIH5+KDEwMCAqIChpbml0U2l6ZSAtIG5kYXRhLmxlbmd0aCkgLyBpbml0U2l6ZSkgKyAiJSIpOwogICAgICB0Q2FudmFzLndpZHRoID0gdENhbnZhcy5oZWlnaHQgPSBjYW52YXMud2lkdGggPSBjYW52YXMuaGVpZ2h0ID0gMDsKICAgICAgcmV0dXJuIG5kYXRhOwogICAgfTsgLy/mt7vliqDkuovku7YKCgogICAgVnVlLnByb3RvdHlwZS5hZGRFdmVudCA9IGZ1bmN0aW9uIChvYmosIHR5cGUsIGZuKSB7CiAgICAgIGlmIChvYmouYWRkRXZlbnRMaXN0ZW5lcikgewogICAgICAgIG9iai5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGZuLCBmYWxzZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb2JqLmF0dGFjaEV2ZW50KCdvbicgKyB0eXBlLCBmbik7CiAgICAgIH0KICAgIH07IC8v56e76Zmk5LqL5Lu2CgoKICAgIFZ1ZS5wcm90b3R5cGUucmVtb3ZlRXZlbnQgPSBmdW5jdGlvbiAob2JqLCB0eXBlLCBmbikgewogICAgICBpZiAob2JqLnJlbW92ZUV2ZW50TGlzdGVuZXIpIHsKICAgICAgICBvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBmbiwgZmFsc2UpOwogICAgICB9IGVsc2UgewogICAgICAgIG9iai5kZXRhY2hFdmVudCgnb24nICsgdHlwZSwgZm4pOwogICAgICB9CiAgICB9OwogIH0KfTs="},{"version":3,"sources":["/Users/yoon/jz-video/src/service/base/clipper.js"],"names":["Cropper","Exif","install","Vue","prototype","initilize","opt","self","options","createElement","resultObj","cropper","preview","aspectRatio","autoCropArea","viewMode","guides","cropBoxResizable","cropBoxMovable","dragCrop","background","checkOrientation","checkCrossOrigin","zoomable","zoomOnWheel","center","toggleDragModeOnDblclick","ready","cropBox","querySelector","style","outline","disable","str","body","document","getElementsByTagName","reagion","id","className","innerHTML","appendChild","getElementById","initFunction","clickBtn","cancelBtn","addEvent","crop","destoried","fileObj","value","clip","e","srcElement","files","target","dataTransfer","length","picValue","originUrl","getObjectURL","replace","file","url","window","createObjectURL","undefined","URL","webkitURL","image","Image","croppedCanvas","roundedCanvas","setTimeout","getCroppedCanvas","getRoundedCanvas","imgData","toDataURL","src","postImg","onload","data","compress","Orientation","sourceCanvas","canvas","context","getContext","width","height","imageSmoothingEnabled","drawImage","globalCompositeOperation","beginPath","rect","fill","removeEvent","parentNode","removeChild","destroy","imageData","console","log","rotateImg","img","direction","min_step","max_step","step","degree","Math","PI","ctx","rotate","tCanvas","tctx","initSize","ratio","sqrt","fillStyle","fillRect","count","nw","nh","i","j","ndata","obj","type","fn","addEventListener","attachEvent","removeEventListener","detachEvent"],"mappings":";;;;;;;;AAAA;;;;;;AAOA,OAAOA,OAAP,MAAoB,WAApB;AACA,OAAOC,IAAP,MAAiB,SAAjB;AACA,eAAe;AACdC,EAAAA,OADc,mBACNC,GADM,EACD;AACZ;AACAA,IAAAA,GAAG,CAACC,SAAJ,CAAcC,SAAd,GAA0B,UAASC,GAAT,EAAc;AACvC,UAAIC,IAAI,GAAG,IAAX;AACA,WAAKC,OAAL,GAAeF,GAAf,CAFuC,CAGvC;;AACA,WAAKG,aAAL;AACA,WAAKC,SAAL,GAAiBJ,GAAG,CAACI,SAArB,CALuC,CAMvC;;AACA,WAAKC,OAAL,GAAe,IAAIX,OAAJ,CAAY,KAAKY,OAAjB,EAA0B;AACxCC,QAAAA,WAAW,EAAEP,GAAG,CAACO,WAAJ,IAAmB,CADQ;AAExCC,QAAAA,YAAY,EAAER,GAAG,CAACQ,YAAJ,IAAoB,GAFM;AAGxCC,QAAAA,QAAQ,EAAE,CAH8B;AAIxCC,QAAAA,MAAM,EAAEV,GAAG,CAACO,WAAJ,IAAmB,MAAnB,GAA4B,KAA5B,GAAoC,IAJJ;AAKxCI,QAAAA,gBAAgB,EAAEX,GAAG,CAACO,WAAJ,IAAmB,MAAnB,GAA4B,KAA5B,GAAoC,IALd;AAMxCK,QAAAA,cAAc,EAAEZ,GAAG,CAACO,WAAJ,IAAmB,MAAnB,GAA4B,KAA5B,GAAoC,IANZ;AAOxCM,QAAAA,QAAQ,EAAEb,GAAG,CAACO,WAAJ,IAAmB,MAAnB,GAA4B,KAA5B,GAAoC,IAPN;AAQxCO,QAAAA,UAAU,EAAE,KAR4B;AASxCC,QAAAA,gBAAgB,EAAE,IATsB;AAUxCC,QAAAA,gBAAgB,EAAE,IAVsB;AAWxCC,QAAAA,QAAQ,EAAE,KAX8B;AAYxCC,QAAAA,WAAW,EAAE,KAZ2B;AAaxCC,QAAAA,MAAM,EAAE,KAbgC;AAcxCC,QAAAA,wBAAwB,EAAE,KAdc;AAexCC,QAAAA,KAAK,EAAE,iBAAW;AACjB;AACA,cAAIrB,GAAG,CAACO,WAAJ,IAAmB,MAAvB,EAA+B;AAC9B,gBAAIe,OAAO,GAAGrB,IAAI,CAACI,OAAL,CAAaiB,OAA3B;AACAA,YAAAA,OAAO,CAACC,aAAR,CAAsB,uBAAtB,EAA+CC,KAA/C,CAAqDC,OAArD,GAA+D,MAA/D;AACAxB,YAAAA,IAAI,CAACI,OAAL,CAAaqB,OAAb;AACA;AACD;AAtBuC,OAA1B,CAAf;AAwBA,KA/BD,CAFY,CAkCZ;;;AACA7B,IAAAA,GAAG,CAACC,SAAJ,CAAcK,aAAd,GAA8B,YAAW;AACxC;AACA,WAAKG,OAAL,GAAe,IAAf;AAEA,UAAIqB,GAAG,GACN,sJADD;AAIA,UAAIC,IAAI,GAAGC,QAAQ,CAACC,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAAX;AACA,WAAKC,OAAL,GAAeF,QAAQ,CAAC1B,aAAT,CAAuB,KAAvB,CAAf;AACA,WAAK4B,OAAL,CAAaC,EAAb,GAAkB,gBAAlB;AACA,WAAKD,OAAL,CAAaE,SAAb,GAAyB,WAAzB;AACA,WAAKF,OAAL,CAAaG,SAAb,GAAyBP,GAAzB,CAZwC,CAaxC;;AACAC,MAAAA,IAAI,CAACO,WAAL,CAAiB,KAAKJ,OAAtB;AACA,WAAKzB,OAAL,GAAeuB,QAAQ,CAACO,cAAT,CAAwB,YAAxB,CAAf,CAfwC,CAiBxC;;AACA,WAAKC,YAAL;AACA,KAnBD,CAnCY,CAuDZ;;;AACAxC,IAAAA,GAAG,CAACC,SAAJ,CAAcuC,YAAd,GAA6B,YAAW;AACvC,UAAIpC,IAAI,GAAG,IAAX;AACA,WAAKqC,QAAL,GAAgBT,QAAQ,CAACO,cAAT,CAAwB,aAAxB,CAAhB;AACA,WAAKG,SAAL,GAAiBV,QAAQ,CAACO,cAAT,CAAwB,aAAxB,CAAjB,CAHuC,CAIvC;;AACA,WAAKI,QAAL,CAAc,KAAKF,QAAnB,EAA6B,OAA7B,EAAsC,YAAW;AAChDrC,QAAAA,IAAI,CAACwC,IAAL;AACA,OAFD,EALuC,CAQvC;;AACA,WAAKD,QAAL,CAAc,KAAKD,SAAnB,EAA8B,OAA9B,EAAuC,YAAW;AACjDtC,QAAAA,IAAI,CAACyC,SAAL;AACA,OAFD,EATuC,CAYvC;;AACA,WAAKF,QAAL,CAAc,KAAKG,OAAnB,EAA4B,OAA5B,EAAqC,YAAW;AAC/C,aAAKC,KAAL,GAAa,EAAb;AACA,OAFD;AAGA,KAhBD,CAxDY,CA0EZ;;;AACA/C,IAAAA,GAAG,CAACC,SAAJ,CAAc+C,IAAd,GAAqB,UAASC,CAAT,EAAY9C,GAAZ,EAAiB;AACrC,UAAIC,IAAI,GAAG,IAAX;AAEA,WAAK0C,OAAL,GAAeG,CAAC,CAACC,UAAjB;AAEA,UAAIC,KAAK,GAAGF,CAAC,CAACG,MAAF,CAASD,KAAT,IAAkBF,CAAC,CAACI,YAAF,CAAeF,KAA7C;AAEA,UAAI,CAACA,KAAK,CAACG,MAAX,EAAmB,OAAO,KAAP,CAPkB,CAOJ;AAEjC;;AACA,WAAKpD,SAAL,CAAeC,GAAf,EAVqC,CAYrC;;AACA,WAAKoD,QAAL,GAAgBJ,KAAK,CAAC,CAAD,CAArB,CAbqC,CAerC;AACA;AACA;AACA;AACA;AAGA;;AACA,WAAKK,SAAL,GAAiB,KAAKC,YAAL,CAAkB,KAAKF,QAAvB,CAAjB,CAvBqC,CAyBrC;;AACA,UAAI,KAAK/C,OAAT,EAAkB;AACjB,aAAKA,OAAL,CAAakD,OAAb,CAAqB,KAAKF,SAA1B;AACA;AAED,KA9BD,CA3EY,CA0GZ;;;AACAxD,IAAAA,GAAG,CAACC,SAAJ,CAAcwD,YAAd,GAA6B,UAASE,IAAT,EAAe;AAC3C,UAAIC,GAAG,GAAG,IAAV;;AACA,UAAIC,MAAM,CAACC,eAAP,IAA0BC,SAA9B,EAAyC;AAAE;AAC1CH,QAAAA,GAAG,GAAGC,MAAM,CAACC,eAAP,CAAuBH,IAAvB,CAAN;AACA,OAFD,MAEO,IAAIE,MAAM,CAACG,GAAP,IAAcD,SAAlB,EAA6B;AAAE;AACrCH,QAAAA,GAAG,GAAGC,MAAM,CAACG,GAAP,CAAWF,eAAX,CAA2BH,IAA3B,CAAN;AACA,OAFM,MAEA,IAAIE,MAAM,CAACI,SAAP,IAAoBF,SAAxB,EAAmC;AAAE;AAC3CH,QAAAA,GAAG,GAAGC,MAAM,CAACI,SAAP,CAAiBH,eAAjB,CAAiCH,IAAjC,CAAN;AACA;;AACD,aAAOC,GAAP;AACA,KAVD,CA3GY,CAsHZ;;;AACA5D,IAAAA,GAAG,CAACC,SAAJ,CAAc2C,IAAd,GAAqB,YAAW;AAC/B,UAAIxC,IAAI,GAAG,IAAX;AACA,UAAI8D,KAAK,GAAG,IAAIC,KAAJ,EAAZ;AACA,UAAIC,aAAJ;AACA,UAAIC,aAAJ,CAJ+B,CAM/B;;AACAC,MAAAA,UAAU,CAAC,YAAW;AACrBF,QAAAA,aAAa,GAAGhE,IAAI,CAACI,OAAL,CAAa+D,gBAAb,EAAhB,CADqB,CAErB;;AACAF,QAAAA,aAAa,GAAGjE,IAAI,CAACoE,gBAAL,CAAsBJ,aAAtB,CAAhB;AAEA,YAAIK,OAAO,GAAGJ,aAAa,CAACK,SAAd,EAAd;AACAR,QAAAA,KAAK,CAACS,GAAN,GAAYF,OAAZ,CANqB,CAQrB;;AACA,YAAIA,OAAO,CAACnB,MAAR,GAAkB,MAAM,IAA5B,EAAmC;AAClClD,UAAAA,IAAI,CAACG,SAAL,CAAeoE,GAAf,GAAqBF,OAArB,CADkC,CAElC;;AACArE,UAAAA,IAAI,CAACwE,OAAL,CAAaH,OAAb;AAEA,SALD,MAKO;AACNP,UAAAA,KAAK,CAACW,MAAN,GAAe,YAAW;AACzB;AACA,gBAAIC,IAAI,GAAG1E,IAAI,CAAC2E,QAAL,CAAcb,KAAd,EAAqB9D,IAAI,CAAC4E,WAA1B,CAAX;AACA5E,YAAAA,IAAI,CAACG,SAAL,CAAeoE,GAAf,GAAqBG,IAArB,CAHyB,CAIzB;;AACA1E,YAAAA,IAAI,CAACwE,OAAL,CAAaE,IAAb;AACA,WAND;AAOA;AACD,OAvBS,EAuBP,EAvBO,CAAV;AAwBA,KA/BD,CAvHY,CAuJZ;;;AACA9E,IAAAA,GAAG,CAACC,SAAJ,CAAcuE,gBAAd,GAAiC,UAASS,YAAT,EAAuB;AAEvD,UAAIC,MAAM,GAAGlD,QAAQ,CAAC1B,aAAT,CAAuB,QAAvB,CAAb;AACA,UAAI6E,OAAO,GAAGD,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAAd;AACA,UAAIC,KAAK,GAAGJ,YAAY,CAACI,KAAzB;AACA,UAAIC,MAAM,GAAGL,YAAY,CAACK,MAA1B;AAEAJ,MAAAA,MAAM,CAACG,KAAP,GAAeA,KAAf;AACAH,MAAAA,MAAM,CAACI,MAAP,GAAgBA,MAAhB;AAEAH,MAAAA,OAAO,CAACI,qBAAR,GAAgC,IAAhC;AACAJ,MAAAA,OAAO,CAACK,SAAR,CAAkBP,YAAlB,EAAgC,CAAhC,EAAmC,CAAnC,EAAsCI,KAAtC,EAA6CC,MAA7C;AACAH,MAAAA,OAAO,CAACM,wBAAR,GAAmC,gBAAnC;AACAN,MAAAA,OAAO,CAACO,SAAR;AACAP,MAAAA,OAAO,CAACQ,IAAR,CAAa,CAAb,EAAgB,CAAhB,EAAmBN,KAAnB,EAA0BC,MAA1B;AACAH,MAAAA,OAAO,CAACS,IAAR;AAEA,aAAOV,MAAP;AACA,KAlBD,CAxJY,CA2KZ;;;AACAlF,IAAAA,GAAG,CAACC,SAAJ,CAAc4C,SAAd,GAA0B,YAAW;AACpC,UAAIzC,IAAI,GAAG,IAAX,CADoC,CAEpC;;AACA,WAAKyF,WAAL,CAAiB,KAAKpD,QAAtB,EAAgC,OAAhC,EAAyC,IAAzC;AACA,WAAKoD,WAAL,CAAiB,KAAKnD,SAAtB,EAAiC,OAAjC,EAA0C,IAA1C;AACA,WAAKmD,WAAL,CAAiB,KAAK/C,OAAtB,EAA+B,OAA/B,EAAwC,IAAxC,EALoC,CAMpC;;AACA,WAAKZ,OAAL,CAAa4D,UAAb,CAAwBC,WAAxB,CAAoC,KAAK7D,OAAzC,EAPoC,CASpC;;AACA,WAAK1B,OAAL,CAAawF,OAAb;AACA,WAAKxF,OAAL,GAAe,IAAf;AACA,KAZD,CA5KY,CAyLZ;;;AACAR,IAAAA,GAAG,CAACC,SAAJ,CAAc2E,OAAd,GAAwB,UAASqB,SAAT,EAAoB;AAG3C;AAIA,UAAI7F,IAAI,GAAG,IAAX;AACAA,MAAAA,IAAI,CAACyC,SAAL;AACAqD,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACA,KAVD,CA1LY,CAsMZ;;;AACAnG,IAAAA,GAAG,CAACC,SAAJ,CAAcmG,SAAd,GAA0B,UAASC,GAAT,EAAcC,SAAd,EAAyBpB,MAAzB,EAAiC;AAC1D;AACA,UAAMqB,QAAQ,GAAG,CAAjB;AACA,UAAMC,QAAQ,GAAG,CAAjB;AACA,UAAIH,GAAG,IAAI,IAAX,EAAiB,OAJyC,CAK1D;;AACA,UAAIf,MAAM,GAAGe,GAAG,CAACf,MAAjB;AACA,UAAID,KAAK,GAAGgB,GAAG,CAAChB,KAAhB;AACA,UAAIoB,IAAI,GAAG,CAAX;;AACA,UAAIA,IAAI,IAAI,IAAZ,EAAkB;AACjBA,QAAAA,IAAI,GAAGF,QAAP;AACA;;AACD,UAAID,SAAS,IAAI,OAAjB,EAA0B;AACzBG,QAAAA,IAAI,GADqB,CAEzB;;AACAA,QAAAA,IAAI,GAAGD,QAAP,KAAoBC,IAAI,GAAGF,QAA3B;AACA,OAJD,MAIO;AACNE,QAAAA,IAAI;AACJA,QAAAA,IAAI,GAAGF,QAAP,KAAoBE,IAAI,GAAGD,QAA3B;AACA,OAnByD,CAoB1D;;;AACA,UAAIE,MAAM,GAAGD,IAAI,GAAG,EAAP,GAAYE,IAAI,CAACC,EAAjB,GAAsB,GAAnC;AACA,UAAIC,GAAG,GAAG3B,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAAV;;AACA,cAAQqB,IAAR;AACC,aAAK,CAAL;AACCvB,UAAAA,MAAM,CAACG,KAAP,GAAeA,KAAf;AACAH,UAAAA,MAAM,CAACI,MAAP,GAAgBA,MAAhB;AACAuB,UAAAA,GAAG,CAACrB,SAAJ,CAAca,GAAd,EAAmB,CAAnB,EAAsB,CAAtB;AACA;;AACD,aAAK,CAAL;AACCnB,UAAAA,MAAM,CAACG,KAAP,GAAeC,MAAf;AACAJ,UAAAA,MAAM,CAACI,MAAP,GAAgBD,KAAhB;AACAwB,UAAAA,GAAG,CAACC,MAAJ,CAAWJ,MAAX;AACAG,UAAAA,GAAG,CAACrB,SAAJ,CAAca,GAAd,EAAmB,CAAnB,EAAsB,CAACf,MAAvB;AACA;;AACD,aAAK,CAAL;AACCJ,UAAAA,MAAM,CAACG,KAAP,GAAeA,KAAf;AACAH,UAAAA,MAAM,CAACI,MAAP,GAAgBA,MAAhB;AACAuB,UAAAA,GAAG,CAACC,MAAJ,CAAWJ,MAAX;AACAG,UAAAA,GAAG,CAACrB,SAAJ,CAAca,GAAd,EAAmB,CAAChB,KAApB,EAA2B,CAACC,MAA5B;AACA;;AACD,aAAK,CAAL;AACCJ,UAAAA,MAAM,CAACG,KAAP,GAAeC,MAAf;AACAJ,UAAAA,MAAM,CAACI,MAAP,GAAgBD,KAAhB;AACAwB,UAAAA,GAAG,CAACC,MAAJ,CAAWJ,MAAX;AACAG,UAAAA,GAAG,CAACrB,SAAJ,CAAca,GAAd,EAAmB,CAAChB,KAApB,EAA2B,CAA3B;AACA;AAvBF;AAyBA,KAhDD,CAvMY,CAyPZ;;;AACArF,IAAAA,GAAG,CAACC,SAAJ,CAAc8E,QAAd,GAAyB,UAASsB,GAAT,EAAcrB,WAAd,EAA2B;AACnD,UAAIE,MAAM,GAAGlD,QAAQ,CAAC1B,aAAT,CAAuB,QAAvB,CAAb;AACA,UAAIuG,GAAG,GAAG3B,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAAV,CAFmD,CAGnD;;AACA,UAAI2B,OAAO,GAAG/E,QAAQ,CAAC1B,aAAT,CAAuB,QAAvB,CAAd;AACA,UAAI0G,IAAI,GAAGD,OAAO,CAAC3B,UAAR,CAAmB,IAAnB,CAAX;AACA,UAAI6B,QAAQ,GAAGZ,GAAG,CAAC1B,GAAJ,CAAQrB,MAAvB;AACA,UAAI+B,KAAK,GAAGgB,GAAG,CAAChB,KAAhB;AACA,UAAIC,MAAM,GAAGe,GAAG,CAACf,MAAjB,CARmD,CAUnD;;AACA,UAAI4B,KAAJ;;AACA,UAAI,CAACA,KAAK,GAAG7B,KAAK,GAAGC,MAAR,GAAiB,OAA1B,IAAqC,CAAzC,EAA4C;AAC3CY,QAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACAe,QAAAA,KAAK,GAAGP,IAAI,CAACQ,IAAL,CAAUD,KAAV,CAAR;AACA7B,QAAAA,KAAK,IAAI6B,KAAT;AACA5B,QAAAA,MAAM,IAAI4B,KAAV;AACA,OALD,MAKO;AACNA,QAAAA,KAAK,GAAG,CAAR;AACA;;AACDhC,MAAAA,MAAM,CAACG,KAAP,GAAeA,KAAf;AACAH,MAAAA,MAAM,CAACI,MAAP,GAAgBA,MAAhB,CArBmD,CAsBnD;;AACAuB,MAAAA,GAAG,CAACO,SAAJ,GAAgB,MAAhB;AACAP,MAAAA,GAAG,CAACQ,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmBnC,MAAM,CAACG,KAA1B,EAAiCH,MAAM,CAACI,MAAxC,EAxBmD,CAyBnD;;AACA,UAAIgC,KAAJ;;AACA,UAAI,CAACA,KAAK,GAAGjC,KAAK,GAAGC,MAAR,GAAiB,OAA1B,IAAqC,CAAzC,EAA4C;AAC3CgC,QAAAA,KAAK,GAAG,CAAC,EAAEX,IAAI,CAACQ,IAAL,CAAUG,KAAV,IAAmB,CAArB,CAAT,CAD2C,CACT;AAClC;;AACA,YAAIC,EAAE,GAAG,CAAC,EAAElC,KAAK,GAAGiC,KAAV,CAAV;AACA,YAAIE,EAAE,GAAG,CAAC,EAAElC,MAAM,GAAGgC,KAAX,CAAV;AACAP,QAAAA,OAAO,CAAC1B,KAAR,GAAgBkC,EAAhB;AACAR,QAAAA,OAAO,CAACzB,MAAR,GAAiBkC,EAAjB;;AACA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,KAApB,EAA2BG,CAAC,EAA5B,EAAgC;AAC/B,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,KAApB,EAA2BI,CAAC,EAA5B,EAAgC;AAC/BV,YAAAA,IAAI,CAACxB,SAAL,CAAea,GAAf,EAAoBoB,CAAC,GAAGF,EAAJ,GAASL,KAA7B,EAAoCQ,CAAC,GAAGF,EAAJ,GAASN,KAA7C,EAAoDK,EAAE,GAAGL,KAAzD,EAAgEM,EAAE,GAAGN,KAArE,EAA4E,CAA5E,EAA+E,CAA/E,EAAkFK,EAAlF,EAAsFC,EAAtF;AACAX,YAAAA,GAAG,CAACrB,SAAJ,CAAcuB,OAAd,EAAuBU,CAAC,GAAGF,EAA3B,EAA+BG,CAAC,GAAGF,EAAnC,EAAuCD,EAAvC,EAA2CC,EAA3C;AACA;AACD;AACD,OAbD,MAaO;AACNX,QAAAA,GAAG,CAACrB,SAAJ,CAAca,GAAd,EAAmB,CAAnB,EAAsB,CAAtB,EAAyBhB,KAAzB,EAAgCC,MAAhC;AACA,OA1CkD,CA2CnD;;;AACA,UAAIN,WAAW,IAAI,EAAf,IAAqBA,WAAW,IAAI,CAAxC,EAA2C;AAC1C,gBAAQA,WAAR;AACC,eAAK,CAAL;AAAQ;AACP,iBAAKoB,SAAL,CAAeC,GAAf,EAAoB,MAApB,EAA4BnB,MAA5B;AACA;;AACD,eAAK,CAAL;AAAQ;AACP,iBAAKkB,SAAL,CAAeC,GAAf,EAAoB,OAApB,EAA6BnB,MAA7B;AACA;;AACD,eAAK,CAAL;AAAQ;AACP,iBAAKkB,SAAL,CAAeC,GAAf,EAAoB,OAApB,EAA6BnB,MAA7B,EADD,CACuC;;AACtC,iBAAKkB,SAAL,CAAeC,GAAf,EAAoB,OAApB,EAA6BnB,MAA7B;AACA;AAVF;AAYA,OAzDkD,CA0DnD;;;AACA,UAAIyC,KAAK,GAAGzC,MAAM,CAACR,SAAP,CAAiB,YAAjB,EAA+B,GAA/B,CAAZ;AACAwB,MAAAA,OAAO,CAACC,GAAR,CAAY,SAASc,QAArB;AACAf,MAAAA,OAAO,CAACC,GAAR,CAAY,SAASwB,KAAK,CAACrE,MAA3B;AACA4C,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAS,CAAC,EAAE,OAAOc,QAAQ,GAAGU,KAAK,CAACrE,MAAxB,IAAkC2D,QAApC,CAAV,GAA0D,GAAtE;AACAF,MAAAA,OAAO,CAAC1B,KAAR,GAAgB0B,OAAO,CAACzB,MAAR,GAAiBJ,MAAM,CAACG,KAAP,GAAeH,MAAM,CAACI,MAAP,GAAgB,CAAhE;AAEA,aAAOqC,KAAP;AACA,KAlED,CA1PY,CA8TZ;;;AACA3H,IAAAA,GAAG,CAACC,SAAJ,CAAc0C,QAAd,GAAyB,UAASiF,GAAT,EAAcC,IAAd,EAAoBC,EAApB,EAAwB;AAChD,UAAIF,GAAG,CAACG,gBAAR,EAA0B;AACzBH,QAAAA,GAAG,CAACG,gBAAJ,CAAqBF,IAArB,EAA2BC,EAA3B,EAA+B,KAA/B;AACA,OAFD,MAEO;AACNF,QAAAA,GAAG,CAACI,WAAJ,CAAgB,OAAOH,IAAvB,EAA6BC,EAA7B;AACA;AACD,KAND,CA/TY,CAsUZ;;;AACA9H,IAAAA,GAAG,CAACC,SAAJ,CAAc4F,WAAd,GAA4B,UAAS+B,GAAT,EAAcC,IAAd,EAAoBC,EAApB,EAAwB;AACnD,UAAIF,GAAG,CAACK,mBAAR,EAA6B;AAC5BL,QAAAA,GAAG,CAACK,mBAAJ,CAAwBJ,IAAxB,EAA8BC,EAA9B,EAAkC,KAAlC;AACA,OAFD,MAEO;AACNF,QAAAA,GAAG,CAACM,WAAJ,CAAgB,OAAOL,IAAvB,EAA6BC,EAA7B;AACA;AACD,KAND;AAOA;AA/Ua,CAAf","sourcesContent":["/**\r\n *\tname : vue 的图片裁减压缩处理\r\n *   dependence :\r\n *       cropper 第三方的一个裁剪库\r\n *       exif    获取图片源信息，解决ios图片旋转的问题\r\n * */\r\n\r\nimport Cropper from 'cropperjs'\r\nimport Exif from 'exif-js'\r\nexport default {\r\n\tinstall(Vue) {\r\n\t\t//初始化方法\r\n\t\tVue.prototype.initilize = function(opt) {\r\n\t\t\tlet self = this;\r\n\t\t\tthis.options = opt;\r\n\t\t\t//创建dom\r\n\t\t\tthis.createElement();\r\n\t\t\tthis.resultObj = opt.resultObj;\r\n\t\t\t//初始化裁剪对象\r\n\t\t\tthis.cropper = new Cropper(this.preview, {\r\n\t\t\t\taspectRatio: opt.aspectRatio || 1,\r\n\t\t\t\tautoCropArea: opt.autoCropArea || 0.8,\r\n\t\t\t\tviewMode: 1,\r\n\t\t\t\tguides: opt.aspectRatio == 'Free' ? false : true,\r\n\t\t\t\tcropBoxResizable: opt.aspectRatio == 'Free' ? false : true,\r\n\t\t\t\tcropBoxMovable: opt.aspectRatio == 'Free' ? false : true,\r\n\t\t\t\tdragCrop: opt.aspectRatio == 'Free' ? false : true,\r\n\t\t\t\tbackground: false,\r\n\t\t\t\tcheckOrientation: true,\r\n\t\t\t\tcheckCrossOrigin: true,\r\n\t\t\t\tzoomable: false,\r\n\t\t\t\tzoomOnWheel: false,\r\n\t\t\t\tcenter: false,\r\n\t\t\t\ttoggleDragModeOnDblclick: false,\r\n\t\t\t\tready: function() {\r\n\t\t\t\t\t// console.log(self.cropper.rotate(90))\r\n\t\t\t\t\tif (opt.aspectRatio == 'Free') {\r\n\t\t\t\t\t\tlet cropBox = self.cropper.cropBox;\r\n\t\t\t\t\t\tcropBox.querySelector('span.cropper-view-box').style.outline = 'none';\r\n\t\t\t\t\t\tself.cropper.disable();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t//创建一些必要的DOM，用于图片裁剪\r\n\t\tVue.prototype.createElement = function() {\r\n\t\t\t//初始化图片为空对象\r\n\t\t\tthis.preview = null;\r\n\r\n\t\t\tlet str =\r\n\t\t\t\t'<div><img id=\"clip_image\" src=\"originUrl\"></div><button type=\"button\" id=\"cancel_clip\">取消</button><button type=\"button\" id=\"clip_button\">确定</button>';\r\n\r\n\r\n\t\t\tlet body = document.getElementsByTagName('body')[0];\r\n\t\t\tthis.reagion = document.createElement('div');\r\n\t\t\tthis.reagion.id = 'clip_container';\r\n\t\t\tthis.reagion.className = 'container';\r\n\t\t\tthis.reagion.innerHTML = str;\r\n\t\t\t//添加创建好的DOM元素\r\n\t\t\tbody.appendChild(this.reagion);\r\n\t\t\tthis.preview = document.getElementById('clip_image');\r\n\r\n\t\t\t//绑定一些方法\r\n\t\t\tthis.initFunction();\r\n\t\t}\r\n\t\t//初始化一些函数绑定\r\n\t\tVue.prototype.initFunction = function() {\r\n\t\t\tlet self = this;\r\n\t\t\tthis.clickBtn = document.getElementById('clip_button');\r\n\t\t\tthis.cancelBtn = document.getElementById('cancel_clip');\r\n\t\t\t//确定事件\r\n\t\t\tthis.addEvent(this.clickBtn, 'click', function() {\r\n\t\t\t\tself.crop();\r\n\t\t\t})\r\n\t\t\t//取消事件\r\n\t\t\tthis.addEvent(this.cancelBtn, 'click', function() {\r\n\t\t\t\tself.destoried();\r\n\t\t\t})\r\n\t\t\t//清空input的值\r\n\t\t\tthis.addEvent(this.fileObj, 'click', function() {\r\n\t\t\t\tthis.value = '';\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t//外部接口，用于input['file']对象change时的调用\r\n\t\tVue.prototype.clip = function(e, opt) {\r\n\t\t\tlet self = this;\r\n\r\n\t\t\tthis.fileObj = e.srcElement;\r\n\r\n\t\t\tlet files = e.target.files || e.dataTransfer.files;\r\n\r\n\t\t\tif (!files.length) return false; //不是图片直接返回\r\n\r\n\t\t\t//调用初始化方法\r\n\t\t\tthis.initilize(opt);\r\n\r\n\t\t\t//获取图片文件资源\r\n\t\t\tthis.picValue = files[0];\r\n\r\n\t\t\t//去获取拍照时的信息，解决拍出来的照片旋转问题\r\n\t\t\t// Exif.getData(files[0], function() {\r\n\t\t\t// \tself.Orientation = Exif.getTag(files[0], 'Orientation');\r\n\t\t\t// \tconsole.log(self.Orientation)\r\n\t\t\t// });\r\n\r\n\r\n\t\t\t//调用方法转成url格式\r\n\t\t\tthis.originUrl = this.getObjectURL(this.picValue);\r\n\r\n\t\t\t//每次替换图片要重新得到新的url\r\n\t\t\tif (this.cropper) {\r\n\t\t\t\tthis.cropper.replace(this.originUrl);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t//图片转码方法\r\n\t\tVue.prototype.getObjectURL = function(file) {\r\n\t\t\tlet url = null;\r\n\t\t\tif (window.createObjectURL != undefined) { // basic\r\n\t\t\t\turl = window.createObjectURL(file);\r\n\t\t\t} else if (window.URL != undefined) { // mozilla(firefox)\r\n\t\t\t\turl = window.URL.createObjectURL(file);\r\n\t\t\t} else if (window.webkitURL != undefined) { // webkit or chrome\r\n\t\t\t\turl = window.webkitURL.createObjectURL(file);\r\n\t\t\t}\r\n\t\t\treturn url;\r\n\t\t}\r\n\t\t//点击确定进行裁剪\r\n\t\tVue.prototype.crop = function() {\r\n\t\t\tlet self = this;\r\n\t\t\tlet image = new Image();\r\n\t\t\tlet croppedCanvas;\r\n\t\t\tlet roundedCanvas;\r\n\r\n\t\t\t// Crop\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tcroppedCanvas = self.cropper.getCroppedCanvas();\r\n\t\t\t\t// Round\r\n\t\t\t\troundedCanvas = self.getRoundedCanvas(croppedCanvas);\r\n\r\n\t\t\t\tlet imgData = roundedCanvas.toDataURL();\r\n\t\t\t\timage.src = imgData;\r\n\r\n\t\t\t\t//判断图片是否大于100k,不大于直接上传，反之压缩\r\n\t\t\t\tif (imgData.length < (100 * 1024)) {\r\n\t\t\t\t\tself.resultObj.src = imgData;\r\n\t\t\t\t\t//图片上传\r\n\t\t\t\t\tself.postImg(imgData);\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\timage.onload = function() {\r\n\t\t\t\t\t\t//压缩处理\r\n\t\t\t\t\t\tlet data = self.compress(image, self.Orientation);\r\n\t\t\t\t\t\tself.resultObj.src = data;\r\n\t\t\t\t\t\t//图片上传\r\n\t\t\t\t\t\tself.postImg(data);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, 20)\r\n\t\t}\r\n\t\t//获取裁剪图片资源\r\n\t\tVue.prototype.getRoundedCanvas = function(sourceCanvas) {\r\n\r\n\t\t\tlet canvas = document.createElement('canvas');\r\n\t\t\tlet context = canvas.getContext('2d');\r\n\t\t\tlet width = sourceCanvas.width;\r\n\t\t\tlet height = sourceCanvas.height;\r\n\r\n\t\t\tcanvas.width = width;\r\n\t\t\tcanvas.height = height;\r\n\r\n\t\t\tcontext.imageSmoothingEnabled = true;\r\n\t\t\tcontext.drawImage(sourceCanvas, 0, 0, width, height);\r\n\t\t\tcontext.globalCompositeOperation = 'destination-in';\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.rect(0, 0, width, height);\r\n\t\t\tcontext.fill();\r\n\r\n\t\t\treturn canvas;\r\n\t\t}\r\n\t\t//销毁原来的对象\r\n\t\tVue.prototype.destoried = function() {\r\n\t\t\tlet self = this;\r\n\t\t\t//移除事件\r\n\t\t\tthis.removeEvent(this.clickBtn, 'click', null);\r\n\t\t\tthis.removeEvent(this.cancelBtn, 'click', null);\r\n\t\t\tthis.removeEvent(this.fileObj, 'click', null);\r\n\t\t\t//移除裁剪框\r\n\t\t\tthis.reagion.parentNode.removeChild(this.reagion);\r\n\r\n\t\t\t//销毁裁剪对象\r\n\t\t\tthis.cropper.destroy();\r\n\t\t\tthis.cropper = null;\r\n\t\t}\r\n\t\t//图片上传\r\n\t\tVue.prototype.postImg = function(imageData) {\r\n\r\n\r\n\t\t\t//这边写图片的上传\r\n\r\n\r\n\r\n\t\t\tlet self = this;\r\n\t\t\tself.destoried();\r\n\t\t\tconsole.log('图片上传结束');\r\n\t\t}\r\n\r\n\t\t//图片旋转\r\n\t\tVue.prototype.rotateImg = function(img, direction, canvas) {\r\n\t\t\t//最小与最大旋转方向，图片旋转4次后回到原方向\r\n\t\t\tconst min_step = 0;\r\n\t\t\tconst max_step = 3;\r\n\t\t\tif (img == null) return;\r\n\t\t\t//img的高度和宽度不能在img元素隐藏后获取，否则会出错\r\n\t\t\tlet height = img.height;\r\n\t\t\tlet width = img.width;\r\n\t\t\tlet step = 2;\r\n\t\t\tif (step == null) {\r\n\t\t\t\tstep = min_step;\r\n\t\t\t}\r\n\t\t\tif (direction == 'right') {\r\n\t\t\t\tstep++;\r\n\t\t\t\t//旋转到原位置，即超过最大值\r\n\t\t\t\tstep > max_step && (step = min_step);\r\n\t\t\t} else {\r\n\t\t\t\tstep--;\r\n\t\t\t\tstep < min_step && (step = max_step);\r\n\t\t\t}\r\n\t\t\t//旋转角度以弧度值为参数\r\n\t\t\tlet degree = step * 90 * Math.PI / 180;\r\n\t\t\tlet ctx = canvas.getContext('2d');\r\n\t\t\tswitch (step) {\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tcanvas.width = width;\r\n\t\t\t\t\tcanvas.height = height;\r\n\t\t\t\t\tctx.drawImage(img, 0, 0);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tcanvas.width = height;\r\n\t\t\t\t\tcanvas.height = width;\r\n\t\t\t\t\tctx.rotate(degree);\r\n\t\t\t\t\tctx.drawImage(img, 0, -height);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tcanvas.width = width;\r\n\t\t\t\t\tcanvas.height = height;\r\n\t\t\t\t\tctx.rotate(degree);\r\n\t\t\t\t\tctx.drawImage(img, -width, -height);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tcanvas.width = height;\r\n\t\t\t\t\tcanvas.height = width;\r\n\t\t\t\t\tctx.rotate(degree);\r\n\t\t\t\t\tctx.drawImage(img, -width, 0);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//图片压缩\r\n\t\tVue.prototype.compress = function(img, Orientation) {\r\n\t\t\tlet canvas = document.createElement(\"canvas\");\r\n\t\t\tlet ctx = canvas.getContext('2d');\r\n\t\t\t//瓦片canvas\r\n\t\t\tlet tCanvas = document.createElement(\"canvas\");\r\n\t\t\tlet tctx = tCanvas.getContext(\"2d\");\r\n\t\t\tlet initSize = img.src.length;\r\n\t\t\tlet width = img.width;\r\n\t\t\tlet height = img.height;\r\n\r\n\t\t\t//如果图片大于四百万像素，计算压缩比并将大小压至400万以下\r\n\t\t\tlet ratio;\r\n\t\t\tif ((ratio = width * height / 4000000) > 1) {\r\n\t\t\t\tconsole.log(\"大于400万像素\")\r\n\t\t\t\tratio = Math.sqrt(ratio);\r\n\t\t\t\twidth /= ratio;\r\n\t\t\t\theight /= ratio;\r\n\t\t\t} else {\r\n\t\t\t\tratio = 1;\r\n\t\t\t}\r\n\t\t\tcanvas.width = width;\r\n\t\t\tcanvas.height = height;\r\n\t\t\t//        铺底色\r\n\t\t\tctx.fillStyle = \"#fff\";\r\n\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\t\t\t//如果图片像素大于100万则使用瓦片绘制\r\n\t\t\tlet count;\r\n\t\t\tif ((count = width * height / 1000000) > 1) {\r\n\t\t\t\tcount = ~~(Math.sqrt(count) + 1); //计算要分成多少块瓦片\r\n\t\t\t\t//            计算每块瓦片的宽和高\r\n\t\t\t\tlet nw = ~~(width / count);\r\n\t\t\t\tlet nh = ~~(height / count);\r\n\t\t\t\ttCanvas.width = nw;\r\n\t\t\t\ttCanvas.height = nh;\r\n\t\t\t\tfor (let i = 0; i < count; i++) {\r\n\t\t\t\t\tfor (let j = 0; j < count; j++) {\r\n\t\t\t\t\t\ttctx.drawImage(img, i * nw * ratio, j * nh * ratio, nw * ratio, nh * ratio, 0, 0, nw, nh);\r\n\t\t\t\t\t\tctx.drawImage(tCanvas, i * nw, j * nh, nw, nh);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tctx.drawImage(img, 0, 0, width, height);\r\n\t\t\t}\r\n\t\t\t//修复ios上传图片的时候 被旋转的问题\r\n\t\t\tif (Orientation != \"\" && Orientation != 1) {\r\n\t\t\t\tswitch (Orientation) {\r\n\t\t\t\t\tcase 6: //需要顺时针（向左）90度旋转\r\n\t\t\t\t\t\tthis.rotateImg(img, 'left', canvas);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 8: //需要逆时针（向右）90度旋转\r\n\t\t\t\t\t\tthis.rotateImg(img, 'right', canvas);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 3: //需要180度旋转\r\n\t\t\t\t\t\tthis.rotateImg(img, 'right', canvas); //转两次\r\n\t\t\t\t\t\tthis.rotateImg(img, 'right', canvas);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//进行最小压缩\r\n\t\t\tlet ndata = canvas.toDataURL('image/jpeg', 0.1);\r\n\t\t\tconsole.log('压缩前：' + initSize);\r\n\t\t\tconsole.log('压缩后：' + ndata.length);\r\n\t\t\tconsole.log('压缩率：' + ~~(100 * (initSize - ndata.length) / initSize) + \"%\");\r\n\t\t\ttCanvas.width = tCanvas.height = canvas.width = canvas.height = 0;\r\n\r\n\t\t\treturn ndata;\r\n\t\t}\r\n\r\n\t\t//添加事件\r\n\t\tVue.prototype.addEvent = function(obj, type, fn) {\r\n\t\t\tif (obj.addEventListener) {\r\n\t\t\t\tobj.addEventListener(type, fn, false);\r\n\t\t\t} else {\r\n\t\t\t\tobj.attachEvent('on' + type, fn);\r\n\t\t\t}\r\n\t\t}\r\n\t\t//移除事件\r\n\t\tVue.prototype.removeEvent = function(obj, type, fn) {\r\n\t\t\tif (obj.removeEventListener) {\r\n\t\t\t\tobj.removeEventListener(type, fn, false);\r\n\t\t\t} else {\r\n\t\t\t\tobj.detachEvent('on' + type, fn);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\n"]}]}